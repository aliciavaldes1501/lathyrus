smat <- abs(cor(clim_vars[, -5])) <= .5
smat
tail(smat)
smat[15:20]
smat[15:20,]
smat[10:20,]
smat[,10:20]
str(smat)
smat[!lower.tri(smat)] <- NA
smat
demo(dredge.subset)
rm(nm)
rm(is.correlated)
rm(vCorrelated)
# Climatic variables to use
clim_vars<-data_sel[c(26:29,38:41,50:53,62:65,74:77,86:89,98:101,110:113,122:125,134:137,146:149,
153,157:161)]
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat <- abs(cor(clim_vars[, -5])) <= .5
smat[!lower.tri(smat)] <- NA
smat
demo(dredge.subset)
data_sel[26]
data_sel[26]
head(data_sel[26])
globmod_FFD<-lmer(FFD ~ data_sel[c(26:29)]+(1|id),data = data_sel)
head(data_sel[c(26:29)])
class(data_sel[c(26:29)])
as.formula( paste( colnames(clim_vars)[i], ".", sep=" ~ "))
as.formula( paste( colnames(clim_vars), ".", sep=" ~ "))
head(data_sel)
subset1
# Variables to use
subset1<-data_sel[c(2,4,26:29,38:41,50:53,62:65,74:77,86:89,98:101,
110:113,122:125,134:137,146:149,153,157:161)]
subset2<-data_sel[c(2,4,26:29)]
globmod_FFD<-lmer(FFD ~ .+(1|id),data = subset2)
globmod_FFD
summary(globmod_FFD)
globmod_FFD<-lmer(FFD ~ .-id+(1|id),data = subset2)
summary(globmod_FFD)
rm(clim_vars)
globmod_FFD<-lmer(FFD ~ .-id+(1|id),data = subset1)
subset1<-data_sel[c(2,4,26:29,38:41,50:53,62:65,74:77,86:89,98:101)]
globmod_FFD<-lmer(FFD ~ .-id+(1|id),data = subset1)
subset1<-data_sel[c(2,4,26:29,38:41)]
globmod_FFD<-lmer(FFD ~ .-id+(1|id),data = subset1)
summary(globmod_FFD)
subset1<-data_sel[c(2,4,26:29,38:41,50:53,62:65,74:77,86:89,98:101)]
globmod_FFD<-lmer(FFD ~ .-id+(1|id),data = subset1)
subset1<-data_sel[c(2,4,26:29,38:41,50:53,62:65,74:77,86:89)]
globmod_FFD<-lmer(FFD ~ .-id+(1|id),data = subset1)
subset1<-data_sel[c(2,4,26:29,38:41,50:53,62:65,74:77)]
globmod_FFD<-lmer(FFD ~ .-id+(1|id),data = subset1)
subset1<-data_sel[c(2,4,26:29,38:41,50:53,62:65)]
globmod_FFD<-lmer(FFD ~ .-id+(1|id),data = subset1)
summary(globmod_FFD)
subset1<-data_sel[c(2,4,26:29,38:41,50:53,62:65,74:77,86:89,98:101,
110:113,122:125,134:137,146:149,153,157:161)]
names(subset1)
subset1<-data_sel[c(98:101,
110:113,122:125,134:137,146:149,153,157:161)]
names(subset1)
subset1<-data_sel[c(122:125,134:137,146:149,153,157:161)]
names(subset1)
globmod_FFD<-lmer(FFD ~ .-id+(1|id),data = subset1)
subset1<-data_sel[c(2,4,122:125,134:137,146:149,153,157:161)]
globmod_FFD<-lmer(FFD ~ .-id+(1|id),data = subset1)
summary(globmod_FFD)
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat <- abs(cor(clim_vars[, -5])) <= .5
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat <- abs(cor(subset1[, -5])) <= .5
names(subset1)
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat <- abs(cor(subset1[3:20][, -5])) <= .5
smat
smat[!lower.tri(smat)] <- NA
smat
smat
# Variables to use
subset1<-data_sel[c(2,4,26:29,38:41,50:53,62:65,74:77,86:89,98:101,
110:113,122:125,134:137,146:149,153,157:161)]
names(subset1)
subset1<-data_sel[c(2,4,122:125,134:137,146:149,153,157:161)]
names(subset1)
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat <- abs(cor(subset1[3:20][, -5])) <= .5
smat
subset1[, -5]
head(subset1[, -5])
names(subset1)
names(subset1[, -5])
subset1<-data_sel[c(2,4,122:125,134:137,146:149,153,157:161)]
globmod_FFD<-lmer(FFD ~ .-id+(1|id),data = subset1)
summary(globmod_FFD)
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat <- abs(cor(subset1[, -2])) <= .5
smat[!lower.tri(smat)] <- NA
smat
smat
subset1<-data_sel[c(2,4,122:125,134:137,146:149,153,157:161)]
globmod_FFD<-lmer(FFD ~ .-id+(1|id),data = subset1)
summary(globmod_FFD)
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat <- abs(cor(subset1[, -2])) <= .5
smat[!lower.tri(smat)] <- NA
rm(smat)
subset1<-data_sel[c(2,4,122:125,134:137,146:149,153,157:161)]
globmod_FFD<-lmer(FFD ~ .-id+(1|id),data = subset1)
summary(globmod_FFD)
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat1 <- abs(cor(subset1[, -2])) <= .5
smat1[!lower.tri(smat)] <- NA
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat1 <- abs(cor(subset1[, -2])) <= .5
smat1[!lower.tri(smat1)] <- NA
modsel_FFD<-dredge(globmod_FFD,fixed=~(1|id),subset=smat1)
modsel_FFD<-dredge(globmod_FFD,fixed=~(1|id),subset=smat1,data = subset1)
globmod_FFD
names(subset1)
paste(names(subset1))
myData[,2:71]
data_sel[,2:71]
names(subset1)
globmod_FFD<-lmer(FFD ~ subset1[,3:20]+(1|id),data = subset1)
subset1<-data_sel[c(2,4,122:125,134:137,146:149,153,157:161)]
names(subset1)
globmod_FFD<-lmer(FFD ~ max_3+max_4+max_5+max_6+mean_3+mean_4+mean_5+mean_6+
min_3+min_4+min_5+min_6+precipitation_1+precipitation_2+
precipitation_3+precipitation_4+precipitation_5+precipitation_6+
(1|id),data = subset1)
summary(globmod_FFD)
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat1 <- abs(cor(subset1[, -2])) <= .5
smat1[!lower.tri(smat1)] <- NA
modsel_FFD<-dredge(globmod_FFD,fixed=~(1|id),subset=smat1,data = subset1)
modsel_FFD<-dredge(globmod_FFD,fixed=~(1|id),subset=smat1)
names(subset1)
names(smat1)
globmod_FFD<-lmer(FFD ~ max_3+max_4+max_5+max_6+mean_3+mean_4+mean_5+mean_6+
min_3+min_4+min_5+min_6+precipitation_1+precipitation_2+
precipitation_3+precipitation_4+precipitation_5+precipitation_6+
(1|id),data = subset1,REML=FALSE)
summary(globmod_FFD)
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat1 <- abs(cor(subset1[, -2])) <= .5
smat1
smat1[!lower.tri(smat1)] <- NA
smat1
names(smat1)
modsel_FFD<-dredge(globmod_FFD,fixed=~(1|id),subset=smat1)
subset1<-data_sel[c(2,4,122:125,134:137,146:149)]
names(subset1)
globmod_FFD<-lmer(FFD ~ max_3+max_4+max_5+max_6+mean_3+mean_4+mean_5+mean_6+
min_3+min_4+min_5+min_6+
(1|id),data = subset1,REML=FALSE)
summary(globmod_FFD)
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat1 <- abs(cor(subset1[, -2])) <= .5
smat1[!lower.tri(smat1)] <- NA
smat1
modsel_FFD<-dredge(globmod_FFD,fixed=~(1|id),subset=smat1)
modsel_FFD
modsel_FFD<-dredge(globmod_FFD,subset=smat1)
modsel_FFD
?get.models
get.models(modsel_FFD)
get.models(modsel_FFD,sbuset=T)
get.models(modsel_FFD,subset=T)
get.models(modsel_FFD,subset=delta<2)
class(get.models(modsel_FFD,subset=delta<2))
str(get.models(modsel_FFD,subset=delta<2))
get.models(modsel_FFD,subset=delta<2)
get.models(modsel_FFD,subset=delta<2)$2625
get.models(modsel_FFD,subset=delta<2)
get.models(modsel_FFD,subset=delta<2)$"2625"
class(get.models(modsel_FFD,subset=delta<2)$"2625")
summary(get.models(modsel_FFD,subset=delta<2)$"2625")
# Variables to use
subset1<-data_sel[c(2,4,26:29,38:41,50:53,62:65,74:77,86:89,98:101,
110:113,122:125,134:137,146:149,153,157:161)]
names(summary(get.models(modsel_FFD,subset=delta<2)$"2625"))
names(subset1)
# Variables to use
subset1<-data_sel[c(2,4,26:28,38:40,50:52,62:64,74:76,86:88,98:100,
110:112,122:124,134:136,146:148,153,157:161)]
names(subset1)
# Variables to use
subset1<-data_sel[c(2,4,26:28,38:40,50:52,62:64,74:76,86:88,98:100,
110:112,122:124,134:136,146:148,153,157:160)]
subset1<-data_sel[c(2,4,98:100,
110:112,122:124,134:136,146:148,153,157:160)]
names(subset1)
subset1<-data_sel[c(2,4,122:124,134:136,146:148,153,157:160)]
names(subset1)
globmod_FFD<-lmer(FFD ~ max_3+max_4+max_5+mean_3+mean_4+mean_5+min_3+min_4+min_5+
precipitation_1+precipitation_2+precipitation_3+precipitation_4+
precipitation_5+(1|id),data = subset1,REML=FALSE)
summary(globmod_FFD)
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat1 <- abs(cor(subset1[, -2])) <= .5
smat1[!lower.tri(smat1)] <- NA
modsel_FFD<-dredge(globmod_FFD,subset=smat1)
modsel_FFD
modsel_FFD
?model.avg
# summary(get.models(modsel_FFD,subset=delta<2)$"2625")
modavg_FFD<-summary(model.avg(modsel_FFD,subset=delta<2))
rm(modavg_FFD)
# summary(get.models(modsel_FFD,subset=delta<2)$"2625")
summary(model.avg(modsel_FFD,subset=delta<2))
cor(data_sel$min_3,data_sel$mean_3)
subset1<-data_sel[c(2,4,122:124,134:136,146:148,153,157:160)]
names(subset1)
globmod_FFD<-lmer(FFD ~ max_3+max_4+max_5+mean_3+mean_4+mean_5+min_3+min_4+min_5+
precipitation_1+precipitation_2+precipitation_3+precipitation_4+
precipitation_5+(1|id),data = subset1,REML=FALSE)
summary(globmod_FFD)
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat1 <- abs(cor(subset1[, -2])) <= .5
smat1[!lower.tri(smat1)] <- NA
smat1
cor(data_sel$max_3,data_sel$mean_3)
demo(dredge.subset)
subset1<-data_sel[c(2,4,122:124,134:136,146:148,153,157:160)]
head(subset1)
globmod_FFD<-lmer(FFD ~ max_3+max_4+max_5+mean_3+mean_4+mean_5+min_3+min_4+min_5+
precipitation_1+precipitation_2+precipitation_3+precipitation_4+
precipitation_5+(1|id),data = subset1,REML=FALSE)
summary(globmod_FFD)
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat1 <- abs(cor(subset1[, -2])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat1[!lower.tri(smat1)] <- NA
smat1
class(smat1)
Cement
Cement[, -5]
abs(cor(Cement[, -5]))
abs(cor(Cement)
)
abs(cor(subset1))
abs(cor(subset1[,-2]))
abs(cor(subset1[,-1,2]))
abs(cor(subset1[,-c(1,2)]))
abs(cor(subset1[,-c(1,2)]))
abs(cor(subset1[, -c(1,2)])) <= .5
smat1[!lower.tri(smat1)] <- NA
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat1 <- abs(cor(subset1[, -c(1,2)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat1[!lower.tri(smat1)] <- NA
smat1
> # smat <- abs(cor(Cement[, -5])) <= .5
> # smat <- abs(cor(Cement[, -5])) <= .5
modsel_FFD<-dredge(globmod_FFD,subset=smat1)
modsel_FFD
# summary(get.models(modsel_FFD,subset=delta<2)$"2625")
summary(model.avg(modsel_FFD,subset=delta<2))
# Variables to use
subset1<-data_sel[c(2,4,26:28,38:40,50:52,62:64,74:76,86:88,98:100,
110:112,122:124,134:136,146:148,153,157:160)]
subset1<-data_sel[c(2,4,122:124,134:136,146:148,153,157:160)]
globmod_FFD<-lmer(FFD ~ max_3+max_4+max_5+mean_3+mean_4+mean_5+min_3+min_4+min_5+
precipitation_1+precipitation_2+precipitation_3+precipitation_4+
precipitation_5+(1|id),data = subset1,REML=FALSE)
summary(globmod_FFD)
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat1 <- abs(cor(subset1[, -c(1,2)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat1[!lower.tri(smat1)] <- NA
modsel_FFD<-dredge(globmod_FFD,subset=smat1)
# Variables to use
subset1<-data_sel[c(2,4,26:28,38:40,50:52,62:64,74:76,86:88,98:100,
110:112,122:124,134:136,146:148,153,157:160)]
names(subset1)
# Variables to use
subset1<-data_sel[c(2,4,26:28,38:40,50:52,62:64,74:76,86:88,98:100,
110:112,122:124,134:136,146:148,153,157:160)]
globmod_FFD<-lmer(FFD ~ max_3+max_4+max_5+mean_3+mean_4+mean_5+min_3+min_4+min_5+
precipitation_1+precipitation_2+precipitation_3+precipitation_4+
precipitation_5+(1|id),data = subset1,REML=FALSE)
summary(globmod_FFD)
names(subset1)
globmod_FFD<-lmer(FFD ~ GDD10_3+GDD10_4+GDD10_5+GDD3_3+GDD3_4+GDD3_5+GDD5_3+
GDD5_4+GDD5_5+GDD7_3+GDD7_4+GDD7_5+GDH10_3+GDH10_4+GDH10_5+
GDH3_3+GDH3_4+GDH3_5+GDH5_3+GDH5_4+GDH5_5+GDH7_3+GDH7_4+GDH7_5+
max_3+max_4+max_5+mean_3+mean_4+mean_5+min_3+min_4+min_5+
precipitation_1+precipitation_2+precipitation_3+precipitation_4+
precipitation_5+(1|id),data = subset1,REML=FALSE)
summary(globmod_FFD)
globmod_FFD<-lmer(FFD ~ GDD5_3+GDD5_4+GDD5_5+GDH5_3+GDH5_4+GDH5_5+
max_3+max_4+max_5+mean_3+mean_4+mean_5+min_3+min_4+min_5+
precipitation_1+precipitation_2+precipitation_3+precipitation_4+
precipitation_5+(1|id),data = subset1,REML=FALSE)
summary(globmod_FFD)
# Generating a subset of a full model excluding collinear variables
# Exclude only pairs of variables having r > 0.5
smat1 <- abs(cor(subset1[, -c(1,2)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat1[!lower.tri(smat1)] <- NA
smat1
modsel_FFD<-dredge(globmod_FFD,subset=smat1)
modsel_FFD
# summary(get.models(modsel_FFD,subset=delta<2)$"2625")
summary(model.avg(modsel_FFD,subset=delta<2))
names(subset1)
names(data_sel[c(2,4,122:124,134:136,146:148,153,157:160)])
?importance
importance(modsel_FFD)
# summary(get.models(modsel_FFD,subset=delta<2)$"2625")
summary(model.avg(modsel_FFD,subset=delta<2))
importance(modsel_FFD)
2^20
str(modsel_FFD)
str(modsel_FFD)
summary(model.avg(modsel_FFD,subset=delta<2))
importance(modsel_FFD)
summary(globmod_FFD)
modsel_FFD[1]
class(modsel_FFD[1])
str(modsel_FFD[1])
str(modsel_FFD[1])
get.models(modsel_FFD[1])
?get.models
get.models(modsel_FFD,subset=1)
class(get.models(modsel_FFD,subset=1))
str(get.models(modsel_FFD,subset=1))
get.models(modsel_FFD,subset=1)$
get.models(modsel_FFD,subset=1)$ 169217
get.models(modsel_FFD,subset=1)$"169217"
summary(get.models(modsel_FFD,subset=1)$"169217")
r.squaredGLMM(get.models(modsel_FFD,subset=1)$"169217") #R square of best model
# Variables to use
subset1<-data_sel[c(2,4,26:28,38:40,50:52,62:64,74:76,86:88,98:100,
110:112,122:124,134:136,146:148,153,157:160)]
globmod_FFD<-lmer(FFD ~ GDD5_3+GDD5_4+GDD5_5+GDH5_3+GDH5_4+GDH5_5+
max_3+max_4+max_5+mean_3+mean_4+mean_5+min_3+min_4+min_5+
precipitation_1+precipitation_2+precipitation_3+precipitation_4+
precipitation_5+(1|id),data = subset1,REML=FALSE)
# Excluding collinear variables with r > 0.5
smat1 <- abs(cor(subset1[, -c(1,2)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat1[!lower.tri(smat1)] <- NA
modsel_FFD<-dredge(globmod_FFD,subset=smat1)
# summary(get.models(modsel_FFD,subset=delta<2)$"2625")
summary(model.avg(modsel_FFD,subset=delta<2)) # Summary averaged model
importance(modsel_FFD) # Variable importance
r.squaredGLMM(get.models(modsel_FFD,subset=1)$"169217") #R square of best model
library(parallel)
# Variables to use
subset1<-data_sel[c(2,4,26:28,38:40,50:52,62:64,74:76,86:88,98:100,
110:112,122:124,134:136,146:148,153,157:160)]
globmod_FFD<-lmer(FFD ~ GDD5_3+GDD5_4+GDD5_5+GDH5_3+GDH5_4+GDH5_5+
max_3+max_4+max_5+mean_3+mean_4+mean_5+min_3+min_4+min_5+
precipitation_1+precipitation_2+precipitation_3+precipitation_4+
precipitation_5+(1|id),data = subset1,REML=FALSE)
# Excluding collinear variables with r > 0.5
smat1 <- abs(cor(subset1[, -c(1,2)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat1[!lower.tri(smat1)] <- NA
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust1 <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust1, "subset1")
# Variables to use
subset1<-data_sel[c(2,4,26:28,38:40,50:52,62:64,74:76,86:88,98:100,
110:112,122:124,134:136,146:148,153,157:160)]
globmod_FFD<-lmer(FFD ~ GDD5_3+GDD5_4+GDD5_5+GDH5_3+GDH5_4+GDH5_5+
max_3+max_4+max_5+mean_3+mean_4+mean_5+min_3+min_4+min_5+
precipitation_1+precipitation_2+precipitation_3+precipitation_4+
precipitation_5+(1|id),data = subset1,REML=FALSE)
# Excluding collinear variables with r > 0.5
smat1 <- abs(cor(subset1[, -c(1,2)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat1[!lower.tri(smat1)] <- NA
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust1 <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust1, "subset1")
clusterEvalQ(clust1, library(lme4))
modsel_FFD<-pdredge(globmod_FFD,subset=smat1,cluster=clust1)
# modsel_FFD<-dredge(globmod_FFD,subset=smat1)
# summary(get.models(modsel_FFD,subset=delta<2)$"2625")
summary(model.avg(modsel_FFD,subset=delta<2)) # Summary averaged model
importance(modsel_FFD) # Variable importance
r.squaredGLMM(get.models(modsel_FFD,subset=1)$"169217") #R square of best model
modsel_FFD
get.models(modsel_FFD,subset=1)
r.squaredGLMM(get.models(modsel_FFD,subset=1)$"169216") #R square of best model
summary(get.models(modsel_FFD,subset=1)$"169216") #R square of best model
head(subset1)
modsel_FFD
# modsel_FFD<-dredge(globmod_FFD,subset=smat1)
# summary(get.models(modsel_FFD,subset=delta<2)$"2625")
summary(model.avg(modsel_FFD,subset=delta<2)) # Summary averaged model
r.squaredGLMM(get.models(modsel_FFD,subset=1)$"169216") #R square of best model
importance(modsel_FFD) # Variable importance
summary(globmod_FFD)
head(data_sel)
table(data_sel$year,data_sel$id)
table(data_sel$id,data_sel$year)
head(data_sel)
head(subset(data_sel,data==0))
class(table(data_sel$id,data_sel$year))
table1<-as.data.table(table(data_sel$id,data_sel$year))
table1<-as.data.frame(table(data_sel$id,data_sel$year))
head(table1)
table1
head(table1)
View(table1)
table(subset(data_sel,period=="old")$id,subset(data_sel,period=="old")$year)
head(data_sel)
table(subset(data_sel,period=="old")$id,subset(data_sel,period=="old")$year)
rm(table1)
table(data_sel$id,data_sel$year)
table1<-table(data_sel$id,data_sel$year)
head(table1)
?rowSums
rowSums(table1)
table1$nyears<-rowSums(table1)
table1<-table(data_sel$id,data_sel$year)
as.vector(rowSums(table1))
table1$nyears<-as.vector(rowSums(table1))
head(table1)
table1<-table(data_sel$id,data_sel$year)
head(table1)
table1<-as.data.frame(table(data_sel$id,data_sel$year))
head(table1)
?aggregate
aggregate(Freq~Var1,table1)
aggregate(Freq~Var1,FUN=sum,table1)
table1$Freq<-aggregate(Freq~Var1,FUN=sum,table1)[2]
head(table1)
aggregate(Freq~Var1,FUN=sum,table1)
aggregate(Freq~Var1,FUN=sum,table1)
head(table1)
table(data_sel$id,data_sel$year)
table1<-as.data.frame(table(data_sel$id,data_sel$year))
str(table1)
str(aggregate(Freq~Var1,FUN=sum,table1))
aggregate(Freq~Var1,FUN=sum,table1)
table2<-aggregate(Freq~Var1,FUN=sum,table1)
head(table2)
str(table2)
table2$Var1<-droplevels(table2$Var1)
str(table2)
hist(table2$Freq)
max(table2$Freq)
subset(table2,Freq==12)
subseT(table1,Var1=="new_13")
subset(table1,Var1=="new_13")
max(table2$Freq,breaks=12)
hist(table2$Freq,breaks=12)
nobs(subset(table2,Freq>5))
nrow(subset(table2,Freq>5))
subset(table2,Freq>5)
nrow(subset(table2,Freq>5))
118-83
nrow(subset(table2,Freq>5))
nrow(subset(table2,Freq>4))
nrow(subset(table2,Freq>3))
nrow(subset(table2,Freq>2))
nrow(subset(table2,Freq>3))
rm(table1)
rm(table2)
# Variables to use
subset1<-data_sel[c(2,4,26:28,38:40,50:52,62:64,74:76,86:88,98:100,
110:112,122:124,134:136,146:148,153,157:160)]
globmod_FFD<-lmer(FFD ~ GDD5_3+GDD5_4+GDD5_5+GDH5_3+GDH5_4+GDH5_5+
max_3+max_4+max_5+mean_3+mean_4+mean_5+min_3+min_4+min_5+
precipitation_1+precipitation_2+precipitation_3+precipitation_4+
precipitation_5+(1|id),data = subset1,REML=FALSE)
# Excluding collinear variables with r > 0.5
smat1 <- abs(cor(subset1[, -c(1,2)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat1[!lower.tri(smat1)] <- NA
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust1 <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust1, "subset1")
clusterEvalQ(clust1, library(lme4))
modsel_FFD<-pdredge(globmod_FFD,subset=smat1,cluster=clust1)
summary(model.avg(modsel_FFD,subset=delta<2)) # Summary averaged model
importance(modsel_FFD) # Variable importance
r.squaredGLMM(get.models(modsel_FFD,subset=1)$"169216") #R square of best model
clusterExport(clust1, "subset1")
clusterEvalQ(clust1, library(lme4))
summary(lm(FFD_mean~mean_4+mean_5+precipitation_1+precipitation_3,
data=mean_weather7))
vif(lm(FFD_mean~mean_4+mean_5+precipitation_1+precipitation_3,data=mean_weather7
)
)
summary(lm(FFD_mean~mean_4+mean_5+precipitation_1+precipitation_3,
data=mean_weather7))
summary(lm(FFD_mean~mean_4+mean_5+precipitation_1+precipitation_3,
data=data_sel))
globmod_FFD_mean<-lm(FFD_mean~mean_4+mean_5+precipitation_1+precipitation_3,
data = mean_weather7)
modsel_FFD_mean<-pdredge(globmod_FFD_mean,cluster=clust1)
modsel_FFD_mean<-dredge(globmod_FFD_mean)
modsel_FFD_mean
summary(model.avg(modsel_FFD_mean,subset=delta<2)) # Summary averaged model
summary(lm(FFD_mean~mean_4+mean_5+precipitation_1+precipitation_3,
data=mean_weather7))
