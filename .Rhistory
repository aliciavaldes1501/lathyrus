tidy(lm(seldiff_FFD~date_10,data=mean_weather5))
glance(lm(seldiff_FFD~date_10,data=mean_weather5))$adj.r.squared # Rsquare
tidy(lm(seldiff_FFD~FFD_mean,data=mean_weather5))
glance(lm(seldiff_FFD~FFD_mean,data=mean_weather5))$adj.r.squared # Rsquare
tidy(lm(seldiff_FFD~date_90,data=mean_weather5))
glance(lm(seldiff_FFD~date_90,data=mean_weather5))$adj.r.squared # Rsquare
tidy(lm(seldiff_FFD~days_90_10,data=mean_weather5))
glance(lm(seldiff_FFD~days_90_10,data=mean_weather5))$adj.r.squared # Rsquare
names(data_sel)
# Variables to use
subset3<-data_sel[c(3,44:46,86:88,158:160,170:172,182:184,189,193:196)]
names(subset3)
names(subset1)
names(subset2)
names(subset3)
# Variables to use
subset3<-data_sel[c(3,44:46,86:88,158:160,170:172,182:184,189,193:196)]
subset3[,c(5:21)]<-scale(subset3[,c(5:21)])
globmod_selection<-lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+
FFD_std:GDD5_3+FFD_std:GDD5_4+FFD_std:GDD5_5+
FFD_std:max_3+FFD_std:max_4+FFD_std:max_5+
FFD_std:mean_3+FFD_std:mean_4+FFD_std:mean_5+
FFD_std:min_3+FFD_std:min_4+FFD_std:min_5+
FFD_std:precipitation_1+FFD_std:precipitation_2+
FFD_std:precipitation_3+FFD_std:precipitation_4+
FFD_std:precipitation_5+(1|id),
data = subset3,REML=FALSE,na.action="na.fail")
# Excluding collinear variables with r > 0.5
smat3 <- abs(cor(subset3[, -c(1:4)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat3[!lower.tri(smat3)] <- NA
smat3
# Variables to use
subset3<-data_sel[c(3,44:46,86:88,158:160,170:172,182:184,189,193:196)]
subset3[,c(5:21)]<-scale(subset3[,c(5:21)])
globmod_selection<-lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+
FFD_std:GDD5_3+FFD_std:GDD5_4+FFD_std:GDD5_5+
FFD_std:max_3+FFD_std:max_4+FFD_std:max_5+
FFD_std:mean_3+FFD_std:mean_4+FFD_std:mean_5+
FFD_std:min_3+FFD_std:min_4+FFD_std:min_5+
FFD_std:precipitation_1+FFD_std:precipitation_2+
FFD_std:precipitation_3+FFD_std:precipitation_4+
FFD_std:precipitation_5+(1|id),
data = subset3,REML=FALSE,na.action="na.fail")
# Excluding collinear variables with r > 0.5
smat3 <- abs(cor(subset3[, -c(1:4)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat3[!lower.tri(smat3)] <- NA
rownames(smat3)<-paste("FFD_std:", names(smat3[1,1:17]),sep="")
colnames(smat3)<-paste("FFD_std:", names(smat3[1,1:17]),sep="")
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust1 <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust1, "subset3")
clusterEvalQ(clust1, library(lme4))
modsel_selection<-pdredge(globmod_selection,subset=smat3,fixed=c("FFD_std","n_fl_std"),
cluster=clust1)
beep()
summary(model.avg(modsel_selection,subset=delta<2)) # Summary averaged model
importance(modsel_selection) # Variable importance
r.squaredGLMM(get.models(modsel_selection,subset=1)$"50180") #R square of best model
# Anova (Table 4A) with model including variables that were significant in the averaged model
Anova(lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+FFD_std:min_4+FFD_std:precipitation_3+(1|id),
data = subset3,REML=FALSE,na.action="na.fail"))
get.models(modsel_selection,subset=1)
# Variables to use
subset3<-data_sel[c(3,44:46,86:88,158:160,170:172,182:184,189,193:196)]
subset3[,c(5:21)]<-scale(subset3[,c(5:21)])
globmod_selection<-lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+
FFD_std:GDD5_3+FFD_std:GDD5_4+FFD_std:GDD5_5+
FFD_std:max_3+FFD_std:max_4+FFD_std:max_5+
FFD_std:mean_3+FFD_std:mean_4+FFD_std:mean_5+
FFD_std:min_3+FFD_std:min_4+FFD_std:min_5+
FFD_std:precipitation_1+FFD_std:precipitation_2+
FFD_std:precipitation_3+FFD_std:precipitation_4+
FFD_std:precipitation_5+(1|id),
data = subset3,REML=FALSE,na.action="na.fail")
# Excluding collinear variables with r > 0.5
smat3 <- abs(cor(subset3[, -c(1:4)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat3[!lower.tri(smat3)] <- NA
rownames(smat3)<-paste("FFD_std:", names(smat3[1,1:17]),sep="")
colnames(smat3)<-paste("FFD_std:", names(smat3[1,1:17]),sep="")
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust1 <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust1, "subset3")
clusterEvalQ(clust1, library(lme4))
modsel_selection<-pdredge(globmod_selection,subset=smat3,fixed=c("FFD_std","n_fl_std"),
cluster=clust1)
summary(model.avg(modsel_selection,subset=delta<2)) # Summary averaged model
importance(modsel_selection) # Variable importance
r.squaredGLMM(get.models(modsel_selection,subset=1)$"50180") #R square of best model
# Anova (Table 4A) with model including variables that were significant in the averaged model
Anova(lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+FFD_std:min_4+FFD_std:precipitation_3+FFD_std:precipitation_4+
(1|id),data = subset3,REML=FALSE,na.action="na.fail"))
Anova(lmer(n_intact_seeds_rel ~ FFD_std+FFD_std:FFD_mean+n_fl_std+(1|id),data = data_sel),type="II")
#No influences of FFD_mean on selection on FFD
Anova(lmer(n_intact_seeds_rel ~ FFD_std+FFD_std:days_90_10+n_fl_std+(1|id),data = data_sel),type="II")
#No influences of days_90_10 on selection on FFD
fig6<-grid.arrange(
ggplot(mean_weather5,aes(x=min_4,y=selgrad_FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Minimum daily\ntemperature April")+ylab(NULL)+my_theme()+
theme(plot.title=element_text(hjust=-0.22,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm")),
ggplot(mean_weather5,aes(x=precipitation_3,y=selgrad_FFD))+ggtitle("B)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Sum of precipitation\nMarch")+ylab(NULL)+
my_theme()+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.22,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm"))+
scale_x_continuous(limits=c(4.5,80)),
ggplot(mean_weather5,aes(x=precipitation_4y=selgrad_FFD))+ggtitle("C)")+
fig6<-grid.arrange(
ggplot(mean_weather5,aes(x=min_4,y=selgrad_FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Minimum daily\ntemperature April")+ylab(NULL)+my_theme()+
theme(plot.title=element_text(hjust=-0.22,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm")),
ggplot(mean_weather5,aes(x=precipitation_3,y=selgrad_FFD))+ggtitle("B)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Sum of precipitation\nMarch")+ylab(NULL)+
my_theme()+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.22,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm"))+
scale_x_continuous(limits=c(4.5,80)),
ggplot(mean_weather5,aes(x=precipitation_4,y=selgrad_FFD))+ggtitle("C)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Sum of precipitation\nApril")+ylab(NULL)+
my_theme()+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.22,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm"))+
scale_x_continuous(limits=c(4.5,80)),
ncol=3,left=textGrob("Selection gradient for\nfirst flowering date",just="center",hjust=0.39,
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90))
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig6.tiff",
plot=fig6,device="tiff",width=28,height=9,units="cm",dpi=600)
fig6<-grid.arrange(
ggplot(mean_weather5,aes(x=min_4,y=selgrad_FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Minimum daily\ntemperature April")+ylab(NULL)+my_theme()+
theme(plot.title=element_text(hjust=-0.18,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm")),
ggplot(mean_weather5,aes(x=precipitation_3,y=selgrad_FFD))+ggtitle("B)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Sum of precipitation\nMarch")+ylab(NULL)+
my_theme()+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.18,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm"))+
scale_x_continuous(limits=c(4.5,80)),
ggplot(mean_weather5,aes(x=precipitation_4,y=selgrad_FFD))+ggtitle("C)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Sum of precipitation\nApril")+ylab(NULL)+
my_theme()+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.18,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm"))+
scale_x_continuous(limits=c(4.5,80)),
ncol=3,left=textGrob("Selection gradient for\nfirst flowering date",just="center",hjust=0.39,
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90))
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig6.tiff",
plot=fig6,device="tiff",width=28,height=9,units="cm",dpi=600)
fig6<-grid.arrange(
ggplot(mean_weather5,aes(x=min_4,y=selgrad_FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Minimum daily\ntemperature April")+ylab(NULL)+my_theme()+
theme(plot.title=element_text(hjust=-0.15,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm")),
ggplot(mean_weather5,aes(x=precipitation_3,y=selgrad_FFD))+ggtitle("B)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Sum of precipitation\nMarch")+ylab(NULL)+
my_theme()+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.15,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm"))+
scale_x_continuous(limits=c(4.5,80)),
ggplot(mean_weather5,aes(x=precipitation_4,y=selgrad_FFD))+ggtitle("C)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Sum of precipitation\nApril")+ylab(NULL)+
my_theme()+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.15,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm"))+
scale_x_continuous(limits=c(4.5,80)),
ncol=3,left=textGrob("Selection gradient for\nfirst flowering date",just="center",hjust=0.39,
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90))
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig6.tiff",
plot=fig6,device="tiff",width=28,height=9,units="cm",dpi=600)
fig6<-grid.arrange(
ggplot(mean_weather5,aes(x=min_4,y=selgrad_FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Minimum daily\ntemperature April")+ylab(NULL)+my_theme()+
theme(plot.title=element_text(hjust=-0.12,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm")),
ggplot(mean_weather5,aes(x=precipitation_3,y=selgrad_FFD))+ggtitle("B)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Sum of precipitation\nMarch")+ylab(NULL)+
my_theme()+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.12,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm"))+
scale_x_continuous(limits=c(4.5,80)),
ggplot(mean_weather5,aes(x=precipitation_4,y=selgrad_FFD))+ggtitle("C)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Sum of precipitation\nApril")+ylab(NULL)+
my_theme()+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.12,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm"))+
scale_x_continuous(limits=c(4.5,80)),
ncol=3,left=textGrob("Selection gradient for\nfirst flowering date",just="center",hjust=0.39,
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90))
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig6.tiff",
plot=fig6,device="tiff",width=28,height=9,units="cm",dpi=600)
range(data_sel$precipitation_4)
range(data_sel$precipitation_3)
subset4<-data_sel[c(3,44:46,86:88,158:160,170:172,182:184,189,193:196)]
modsel_sig<-lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+FFD_std:min_4+FFD_std:precipitation_3+
FFD_std:precipitation_4+(1|id),data = subset4,REML=FALSE,na.action="na.fail")
interaction1<-data.frame(effect(term="FFD_std:min_4",mod=modsel_sig,
xlevels=list(FFD_std=seq(-3.9,4.2,0.1),
min_4=seq(-0.1,3.8,0.1))))
interaction1$fit_mod<-with(interaction1,ifelse(fit<0,0,fit))
interaction2<-data.frame(effect(term="FFD_std:precipitation_3",mod=modsel_sig,
xlevels=list(FFD_std=seq(-3.9,4.2,0.1),
precipitation_3=seq(4.8,78.2,1))))
interaction2$fit_mod<-with(interaction2,ifelse(fit<0,0,fit))
interaction3<-data.frame(effect(term="FFD_std:precipitation_4",mod=modsel_sig,
xlevels=list(FFD_std=seq(-3.9,4.2,0.1),
precipitation_4=seq(3.7,79.8,1))))
interaction3$fit_mod<-with(interaction3,ifelse(fit<0,0,fit))
myPalette <- colorRampPalette(brewer.pal(11, "YlOrRd"))
p1<-ggplot(interaction1, aes(FFD_std,fit_mod, group = as.factor(min_4)))+
geom_smooth(method=lm,se=F,size=0.5,aes(FFD_std,fit_mod,color=min_4))+
xlab("Standardized first flowering date")+ylab(NULL)+ggtitle("A)")+
my_theme()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Minimum daily\ntemperature April")+
theme(plot.margin = unit(c(0.1,0.3,0.1,0.3), "cm"))+
theme(plot.title=element_text(hjust=-0.10,vjust=-16))+
scale_y_continuous(limit=c(0,3.2))
myPalette <- colorRampPalette(brewer.pal(11, "Blues"))
p2<-ggplot(interaction2, aes(FFD_std,fit_mod, group = as.factor(precipitation_3)))+
geom_smooth(method=lm,se=F,size=0.5,aes(FFD_std,fit_mod,color=precipitation_3))+
xlab("Standardized first flowering date")+ylab(NULL)+ggtitle("B)")+
my_theme()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Sum of\nprecipitation March")+
theme(axis.text.y=element_text(color="white"))+
theme(plot.margin = unit(c(0.1,0.3,0.1,0.3), "cm"))+
theme(plot.title=element_text(hjust=-0.10,vjust=-16))+
scale_y_continuous(limit=c(0,3.2))
p3<-ggplot(interaction3, aes(FFD_std,fit_mod, group = as.factor(precipitation_4)))+
geom_smooth(method=lm,se=F,size=0.5,aes(FFD_std,fit_mod,color=precipitation_4))+
xlab("Standardized first flowering date")+ylab(NULL)+ggtitle("C)")+
my_theme()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Sum of\nprecipitation April")+
theme(axis.text.y=element_text(color="white"))+
theme(plot.margin = unit(c(0.1,0.3,0.1,0.3), "cm"))+
theme(plot.title=element_text(hjust=-0.10,vjust=-16))+
scale_y_continuous(limit=c(0,3.2))
fig6alt<-grid.arrange(p1,p2,p3,ncol=3,
left=textGrob("Relative number of intact seeds",
just="center",hjust=0.63,
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90))
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig6alt.tiff",
plot=fig6alt,device="tiff",width=28,height=11,units="cm",dpi=600)
subset4<-data_sel[c(3,44:46,86:88,158:160,170:172,182:184,189,193:196)]
modsel_sig<-lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+FFD_std:min_4+FFD_std:precipitation_3+
FFD_std:precipitation_4+(1|id),data = subset4,REML=FALSE,na.action="na.fail")
interaction1<-data.frame(effect(term="FFD_std:min_4",mod=modsel_sig,
xlevels=list(FFD_std=seq(-3.9,4.2,0.1),
min_4=seq(-0.1,3.8,0.1))))
interaction1$fit_mod<-with(interaction1,ifelse(fit<0,0,fit))
interaction2<-data.frame(effect(term="FFD_std:precipitation_3",mod=modsel_sig,
xlevels=list(FFD_std=seq(-3.9,4.2,0.1),
precipitation_3=seq(4.8,78.2,1))))
interaction2$fit_mod<-with(interaction2,ifelse(fit<0,0,fit))
interaction3<-data.frame(effect(term="FFD_std:precipitation_4",mod=modsel_sig,
xlevels=list(FFD_std=seq(-3.9,4.2,0.1),
precipitation_4=seq(3.7,79.8,2))))
interaction3$fit_mod<-with(interaction3,ifelse(fit<0,0,fit))
myPalette <- colorRampPalette(brewer.pal(11, "YlOrRd"))
p1<-ggplot(interaction1, aes(FFD_std,fit_mod, group = as.factor(min_4)))+
geom_smooth(method=lm,se=F,size=0.5,aes(FFD_std,fit_mod,color=min_4))+
xlab("Standardized first flowering date")+ylab(NULL)+ggtitle("A)")+
my_theme()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Minimum daily\ntemperature April")+
theme(plot.margin = unit(c(0.1,0.3,0.1,0.3), "cm"))+
theme(plot.title=element_text(hjust=-0.10,vjust=-16))+
scale_y_continuous(limit=c(0,3.2))
myPalette <- colorRampPalette(brewer.pal(11, "Blues"))
p2<-ggplot(interaction2, aes(FFD_std,fit_mod, group = as.factor(precipitation_3)))+
geom_smooth(method=lm,se=F,size=0.5,aes(FFD_std,fit_mod,color=precipitation_3))+
xlab("Standardized first flowering date")+ylab(NULL)+ggtitle("B)")+
my_theme()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Sum of\nprecipitation March")+
theme(axis.text.y=element_text(color="white"))+
theme(plot.margin = unit(c(0.1,0.3,0.1,0.3), "cm"))+
theme(plot.title=element_text(hjust=-0.10,vjust=-16))+
scale_y_continuous(limit=c(0,3.2))
p3<-ggplot(interaction3, aes(FFD_std,fit_mod, group = as.factor(precipitation_4)))+
geom_smooth(method=lm,se=F,size=0.5,aes(FFD_std,fit_mod,color=precipitation_4))+
xlab("Standardized first flowering date")+ylab(NULL)+ggtitle("C)")+
my_theme()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Sum of\nprecipitation April")+
theme(axis.text.y=element_text(color="white"))+
theme(plot.margin = unit(c(0.1,0.3,0.1,0.3), "cm"))+
theme(plot.title=element_text(hjust=-0.10,vjust=-16))+
scale_y_continuous(limit=c(0,3.2))
fig6alt<-grid.arrange(p1,p2,p3,ncol=3,
left=textGrob("Relative number of intact seeds",
just="center",hjust=0.63,
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90))
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig6alt.tiff",
plot=fig6alt,device="tiff",width=28,height=11,units="cm",dpi=600)
subset4<-data_sel[c(3,44:46,86:88,158:160,170:172,182:184,189,193:196)]
modsel_sig<-lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+FFD_std:min_4+FFD_std:precipitation_3+
FFD_std:precipitation_4+(1|id),data = subset4,REML=FALSE,na.action="na.fail")
interaction1<-data.frame(effect(term="FFD_std:min_4",mod=modsel_sig,
xlevels=list(FFD_std=seq(-3.9,4.2,0.1),
min_4=seq(-0.1,3.8,0.1))))
interaction1$fit_mod<-with(interaction1,ifelse(fit<0,0,fit))
interaction2<-data.frame(effect(term="FFD_std:precipitation_3",mod=modsel_sig,
xlevels=list(FFD_std=seq(-3.9,4.2,0.1),
precipitation_3=seq(4.8,78.2,1))))
interaction2$fit_mod<-with(interaction2,ifelse(fit<0,0,fit))
interaction3<-data.frame(effect(term="FFD_std:precipitation_4",mod=modsel_sig,
xlevels=list(FFD_std=seq(-3.9,4.2,0.1),
precipitation_4=seq(3.7,79.8,3))))
interaction3$fit_mod<-with(interaction3,ifelse(fit<0,0,fit))
myPalette <- colorRampPalette(brewer.pal(11, "YlOrRd"))
p1<-ggplot(interaction1, aes(FFD_std,fit_mod, group = as.factor(min_4)))+
geom_smooth(method=lm,se=F,size=0.5,aes(FFD_std,fit_mod,color=min_4))+
xlab("Standardized first flowering date")+ylab(NULL)+ggtitle("A)")+
my_theme()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Minimum daily\ntemperature April")+
theme(plot.margin = unit(c(0.1,0.3,0.1,0.3), "cm"))+
theme(plot.title=element_text(hjust=-0.10,vjust=-16))+
scale_y_continuous(limit=c(0,3.2))
myPalette <- colorRampPalette(brewer.pal(11, "Blues"))
p2<-ggplot(interaction2, aes(FFD_std,fit_mod, group = as.factor(precipitation_3)))+
geom_smooth(method=lm,se=F,size=0.5,aes(FFD_std,fit_mod,color=precipitation_3))+
xlab("Standardized first flowering date")+ylab(NULL)+ggtitle("B)")+
my_theme()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Sum of\nprecipitation March")+
theme(axis.text.y=element_text(color="white"))+
theme(plot.margin = unit(c(0.1,0.3,0.1,0.3), "cm"))+
theme(plot.title=element_text(hjust=-0.10,vjust=-16))+
scale_y_continuous(limit=c(0,3.2))
p3<-ggplot(interaction3, aes(FFD_std,fit_mod, group = as.factor(precipitation_4)))+
geom_smooth(method=lm,se=F,size=0.5,aes(FFD_std,fit_mod,color=precipitation_4))+
xlab("Standardized first flowering date")+ylab(NULL)+ggtitle("C)")+
my_theme()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Sum of\nprecipitation April")+
theme(axis.text.y=element_text(color="white"))+
theme(plot.margin = unit(c(0.1,0.3,0.1,0.3), "cm"))+
theme(plot.title=element_text(hjust=-0.10,vjust=-16))+
scale_y_continuous(limit=c(0,3.2))
fig6alt<-grid.arrange(p1,p2,p3,ncol=3,
left=textGrob("Relative number of intact seeds",
just="center",hjust=0.63,
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90))
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig6alt.tiff",
plot=fig6alt,device="tiff",width=28,height=11,units="cm",dpi=600)
subset4<-data_sel[c(3,44:46,86:88,158:160,170:172,182:184,189,193:196)]
modsel_sig<-lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+FFD_std:min_4+FFD_std:precipitation_3+
FFD_std:precipitation_4+(1|id),data = subset4,REML=FALSE,na.action="na.fail")
interaction1<-data.frame(effect(term="FFD_std:min_4",mod=modsel_sig,
xlevels=list(FFD_std=seq(-3.9,4.2,0.1),
min_4=seq(-0.1,3.8,0.1))))
interaction1$fit_mod<-with(interaction1,ifelse(fit<0,0,fit))
interaction2<-data.frame(effect(term="FFD_std:precipitation_3",mod=modsel_sig,
xlevels=list(FFD_std=seq(-3.9,4.2,0.1),
precipitation_3=seq(4.8,78.2,1))))
interaction2$fit_mod<-with(interaction2,ifelse(fit<0,0,fit))
interaction3<-data.frame(effect(term="FFD_std:precipitation_4",mod=modsel_sig,
xlevels=list(FFD_std=seq(-3.9,4.2,0.1),
precipitation_4=seq(3.7,79.8,2))))
interaction3$fit_mod<-with(interaction3,ifelse(fit<0,0,fit))
myPalette <- colorRampPalette(brewer.pal(11, "YlOrRd"))
p1<-ggplot(interaction1, aes(FFD_std,fit_mod, group = as.factor(min_4)))+
geom_smooth(method=lm,se=F,size=0.5,aes(FFD_std,fit_mod,color=min_4))+
xlab("Standardized first flowering date")+ylab(NULL)+ggtitle("A)")+
my_theme()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Minimum daily\ntemperature April")+
theme(plot.margin = unit(c(0.1,0.3,0.1,0.3), "cm"))+
theme(plot.title=element_text(hjust=-0.10,vjust=-16))+
scale_y_continuous(limit=c(0,3.2))
myPalette <- colorRampPalette(brewer.pal(11, "Blues"))
p2<-ggplot(interaction2, aes(FFD_std,fit_mod, group = as.factor(precipitation_3)))+
geom_smooth(method=lm,se=F,size=0.5,aes(FFD_std,fit_mod,color=precipitation_3))+
xlab("Standardized first flowering date")+ylab(NULL)+ggtitle("B)")+
my_theme()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Sum of\nprecipitation March")+
theme(axis.text.y=element_text(color="white"))+
theme(plot.margin = unit(c(0.1,0.3,0.1,0.3), "cm"))+
theme(plot.title=element_text(hjust=-0.10,vjust=-16))+
scale_y_continuous(limit=c(0,3.2))
p3<-ggplot(interaction3, aes(FFD_std,fit_mod, group = as.factor(precipitation_4)))+
geom_smooth(method=lm,se=F,size=0.5,aes(FFD_std,fit_mod,color=precipitation_4))+
xlab("Standardized first flowering date")+ylab(NULL)+ggtitle("C)")+
my_theme()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Sum of\nprecipitation April")+
theme(axis.text.y=element_text(color="white"))+
theme(plot.margin = unit(c(0.1,0.3,0.1,0.3), "cm"))+
theme(plot.title=element_text(hjust=-0.10,vjust=-16))+
scale_y_continuous(limit=c(0,3.2))
fig6alt<-grid.arrange(p1,p2,p3,ncol=3,
left=textGrob("Relative number of intact seeds",
just="center",hjust=0.63,
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90))
dev.off()
fig6<-grid.arrange(
ggplot(mean_weather5,aes(x=min_4,y=selgrad_FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Minimum daily\ntemperature April")+ylab(NULL)+my_theme()+
theme(plot.title=element_text(hjust=-0.12,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm")),
ggplot(mean_weather5,aes(x=precipitation_3,y=selgrad_FFD))+ggtitle("B)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Sum of precipitation\nMarch")+ylab(NULL)+
my_theme()+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.12,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm"))+
scale_x_continuous(limits=c(4.5,80)),
ggplot(mean_weather5,aes(x=precipitation_4,y=selgrad_FFD))+ggtitle("C)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
geom_hline(yintercept=0,size=0.5,colour="grey",linetype="dashed")+
xlab("Sum of precipitation\nApril")+ylab(NULL)+
my_theme()+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.12,vjust=-2))+
theme(plot.margin = unit(c(0.07,0.05,0.07,0.05), "cm"))+
scale_x_continuous(limits=c(4.5,80)),
ncol=3,left=textGrob("Selection gradient for\nfirst flowering date",just="center",hjust=0.39,
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90))
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig6.tiff",
plot=fig6,device="tiff",width=28,height=9,units="cm",dpi=600)
subset4<-data_sel[c(3,44:46,86:88,158:160,170:172,182:184,189,193:196)]
modsel_sig<-lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+FFD_std:min_4+FFD_std:precipitation_3+
FFD_std:precipitation_4+(1|id),data = subset4,REML=FALSE,na.action="na.fail")
interaction1<-data.frame(effect(term="FFD_std:min_4",mod=modsel_sig,
xlevels=list(FFD_std=seq(-3.9,4.2,0.1),
min_4=seq(-0.1,3.8,0.1))))
interaction1$fit_mod<-with(interaction1,ifelse(fit<0,0,fit))
interaction2<-data.frame(effect(term="FFD_std:precipitation_3",mod=modsel_sig,
xlevels=list(FFD_std=seq(-3.9,4.2,0.1),
precipitation_3=seq(4.8,78.2,1))))
interaction2$fit_mod<-with(interaction2,ifelse(fit<0,0,fit))
interaction3<-data.frame(effect(term="FFD_std:precipitation_4",mod=modsel_sig,
xlevels=list(FFD_std=seq(-3.9,4.2,0.1),
precipitation_4=seq(3.7,79.8,2))))
interaction3$fit_mod<-with(interaction3,ifelse(fit<0,0,fit))
myPalette <- colorRampPalette(brewer.pal(11, "YlOrRd"))
p1<-ggplot(interaction1, aes(FFD_std,fit_mod, group = as.factor(min_4)))+
geom_smooth(method=lm,se=F,size=0.5,aes(FFD_std,fit_mod,color=min_4))+
xlab("Standardized first flowering date")+ylab(NULL)+ggtitle("A)")+
my_theme()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Minimum daily\ntemperature April")+
theme(plot.margin = unit(c(0.1,0.3,0.1,0.3), "cm"))+
theme(plot.title=element_text(hjust=-0.10,vjust=-16))+
scale_y_continuous(limit=c(0,3.2))
myPalette <- colorRampPalette(brewer.pal(11, "Blues"))
p2<-ggplot(interaction2, aes(FFD_std,fit_mod, group = as.factor(precipitation_3)))+
geom_smooth(method=lm,se=F,size=0.5,aes(FFD_std,fit_mod,color=precipitation_3))+
xlab("Standardized first flowering date")+ylab(NULL)+ggtitle("B)")+
my_theme()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Sum of\nprecipitation March")+
theme(axis.text.y=element_text(color="white"))+
theme(plot.margin = unit(c(0.1,0.3,0.1,0.3), "cm"))+
theme(plot.title=element_text(hjust=-0.10,vjust=-16))+
scale_y_continuous(limit=c(0,3.2))
p3<-ggplot(interaction3, aes(FFD_std,fit_mod, group = as.factor(precipitation_4)))+
geom_smooth(method=lm,se=F,size=0.5,aes(FFD_std,fit_mod,color=precipitation_4))+
xlab("Standardized first flowering date")+ylab(NULL)+ggtitle("C)")+
my_theme()+scale_colour_gradientn(colours = myPalette(100))+
theme(legend.position="top")+labs(colour="Sum of\nprecipitation April")+
theme(axis.text.y=element_text(color="white"))+
theme(plot.margin = unit(c(0.1,0.3,0.1,0.3), "cm"))+
theme(plot.title=element_text(hjust=-0.10,vjust=-16))+
scale_y_continuous(limit=c(0,3.2))
fig6alt<-grid.arrange(p1,p2,p3,ncol=3,
left=textGrob("Relative number of intact seeds",
just="center",hjust=0.63,
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90))
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig6alt.tiff",
plot=fig6alt,device="tiff",width=28,height=11,units="cm",dpi=600)
globmod_FFD_mean<-lm(FFD_mean~scale(mean_4)+scale(max_5)+
scale(precipitation_1)+scale(precipitation_3),
data = mean_weather4,na.action="na.fail")
modsel_FFD_mean<-dredge(globmod_FFD_mean)
summary(model.avg(modsel_FFD_mean,subset=delta<2)) # Summary averaged model
importance(modsel_FFD_mean) # Variable importance
summary(get.models(modsel_FFD_mean,subset=1)$"8")$adj.r.squared #R square of best model
## FFD_mean also related to temp when including year  (Table S4)
tidy(lm(FFD_mean~scale(mean_4)+scale(max_5)+year,data=mean_weather4))
glance(lm(FFD_mean~scale(mean_4)+scale(max_5)+year,data=mean_weather4))$adj.r.squared # Rsquare
globmod_date_90<-lm(date_90~scale(mean_4)+scale(max_5)+
scale(precipitation_1)+scale(precipitation_3),
data = mean_weather4,na.action="na.fail")
modsel_date_90<-dredge(globmod_date_90)
summary(model.avg(modsel_date_90,subset=delta<2)) # Summary averaged model
importance(modsel_date_90) # Variable importance
summary(get.models(modsel_date_90,subset=1)$"4")$adj.r.squared #R square of best model
## date_90 also related to temp when including year  (Table S4)
tidy(lm(date_90~scale(mean_4)+scale(max_5)+year,data=mean_weather4))
glance(lm(date_90~scale(mean_4)+scale(max_5)+year,data=mean_weather4))$adj.r.squared # Rsquare
