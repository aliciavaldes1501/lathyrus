geom_point(aes(x=max_5,y=date_10),shape=24)+
geom_smooth(aes(x=max_5,y=date_10),method="lm",color="black",lty="dashed",se=F)+
geom_point(aes(x=max_5,y=FFD_mean),shape=19)+
geom_smooth(aes(x=max_5,y=FFD_mean),method="lm",color="black",se=F)+
geom_point(aes(x=max_5,y=date_90),shape=8)+
geom_smooth(aes(x=max_5,y=date_90),method="lm",color="black",lty="dotted",se=F)+
xlab(NULL)+ylab(NULL)+my_theme()+
scale_y_continuous(limits=c(40,80))+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.15,vjust=0,color="white"))+
theme(axis.text.x=element_text(color="white"))+
theme(axis.title.x=element_text(color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ncol=2,left=textGrob("Day from vernal equinox",
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90,hjust=0.46))
fig3B<-grid.arrange(
ggplot(mean_weather5)+ggtitle("B)")+
geom_point(aes(x=min_4,y=days_90_10),shape=19)+
geom_smooth(aes(x=min_4,y=days_90_10),method="lm",color="black",se=F)+
xlab("Minimum daily temperature April")+ylab(NULL)+my_theme()+
theme(plot.title=element_text(hjust=-0.14,vjust=0))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ggplot(mean_weather5)+ggtitle("B)")+
geom_point(aes(x=max_5,y=days_90_10),shape=19)+
geom_smooth(aes(x=max_5,y=days_90_10),method="lm",color="black",se=F)+
xlab("Maximum daily temperature May")+ylab(NULL)+my_theme()+
theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.14,vjust=0,color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ncol=2,left=textGrob("Duration of flowering season",
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90,hjust=0.46))
fig3<-grid.arrange(fig3A,fig3B)
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig3.tiff",
plot=fig3,device="tiff",width=19,height=18,units="cm",dpi=600)
fig3A<-grid.arrange(
ggplot(mean_weather5)+ggtitle("A)")+
geom_point(aes(x=min_4,y=date_10),shape=24)+
geom_smooth(aes(x=min_4,y=date_10),method="lm",color="black",lty="dashed",se=F)+
geom_point(aes(x=min_4,y=FFD_mean),shape=19)+
geom_smooth(aes(x=min_4,y=FFD_mean),method="lm",color="black",se=F)+
geom_point(aes(x=min_4,y=date_90),shape=8)+
geom_smooth(aes(x=min_4,y=date_90),method="lm",color="black",lty="dotted",se=F)+
xlab(NULL)+ylab(NULL)+my_theme()+
scale_y_continuous(limits=c(40,80))+
theme(plot.title=element_text(hjust=-0.17,vjust=1))+
theme(axis.text.x=element_text(color="white"))+
theme(axis.title.x=element_text(color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ggplot(mean_weather5)+ggtitle("A)")+
geom_point(aes(x=max_5,y=date_10),shape=24)+
geom_smooth(aes(x=max_5,y=date_10),method="lm",color="black",lty="dashed",se=F)+
geom_point(aes(x=max_5,y=FFD_mean),shape=19)+
geom_smooth(aes(x=max_5,y=FFD_mean),method="lm",color="black",se=F)+
geom_point(aes(x=max_5,y=date_90),shape=8)+
geom_smooth(aes(x=max_5,y=date_90),method="lm",color="black",lty="dotted",se=F)+
xlab(NULL)+ylab(NULL)+my_theme()+
scale_y_continuous(limits=c(40,80))+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.17,vjust=1,color="white"))+
theme(axis.text.x=element_text(color="white"))+
theme(axis.title.x=element_text(color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ncol=2,left=textGrob("Day from vernal equinox",
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90,hjust=0.46))
fig3B<-grid.arrange(
ggplot(mean_weather5)+ggtitle("B)")+
geom_point(aes(x=min_4,y=days_90_10),shape=19)+
geom_smooth(aes(x=min_4,y=days_90_10),method="lm",color="black",se=F)+
xlab("Minimum daily temperature April")+ylab(NULL)+my_theme()+
theme(plot.title=element_text(hjust=-0.17,vjust=1))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ggplot(mean_weather5)+ggtitle("B)")+
geom_point(aes(x=max_5,y=days_90_10),shape=19)+
geom_smooth(aes(x=max_5,y=days_90_10),method="lm",color="black",se=F)+
xlab("Maximum daily temperature May")+ylab(NULL)+my_theme()+
theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.17,vjust=1,color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ncol=2,left=textGrob("Duration of flowering season",
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90,hjust=0.46))
fig3<-grid.arrange(fig3A,fig3B)
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig3.tiff",
plot=fig3,device="tiff",width=19,height=18,units="cm",dpi=600)
fig3A<-grid.arrange(
ggplot(mean_weather5)+ggtitle("A)")+
geom_point(aes(x=min_4,y=date_10),shape=24)+
geom_smooth(aes(x=min_4,y=date_10),method="lm",color="black",lty="dashed",se=F)+
geom_point(aes(x=min_4,y=FFD_mean),shape=19)+
geom_smooth(aes(x=min_4,y=FFD_mean),method="lm",color="black",se=F)+
geom_point(aes(x=min_4,y=date_90),shape=8)+
geom_smooth(aes(x=min_4,y=date_90),method="lm",color="black",lty="dotted",se=F)+
xlab(NULL)+ylab(NULL)+my_theme()+
scale_y_continuous(limits=c(40,80))+
theme(plot.title=element_text(hjust=-0.17,vjust=1))+
theme(axis.title.x=element_text(color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ggplot(mean_weather5)+ggtitle("A)")+
geom_point(aes(x=max_5,y=date_10),shape=24)+
geom_smooth(aes(x=max_5,y=date_10),method="lm",color="black",lty="dashed",se=F)+
geom_point(aes(x=max_5,y=FFD_mean),shape=19)+
geom_smooth(aes(x=max_5,y=FFD_mean),method="lm",color="black",se=F)+
geom_point(aes(x=max_5,y=date_90),shape=8)+
geom_smooth(aes(x=max_5,y=date_90),method="lm",color="black",lty="dotted",se=F)+
xlab(NULL)+ylab(NULL)+my_theme()+
scale_y_continuous(limits=c(40,80))+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.17,vjust=1,color="white"))+
theme(axis.title.x=element_text(color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ncol=2,left=textGrob("Day from vernal equinox",
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90,hjust=0.46))
fig3B<-grid.arrange(
ggplot(mean_weather5)+ggtitle("B)")+
geom_point(aes(x=min_4,y=days_90_10),shape=19)+
geom_smooth(aes(x=min_4,y=days_90_10),method="lm",color="black",se=F)+
xlab("Minimum daily temperature April")+ylab(NULL)+my_theme()+
theme(plot.title=element_text(hjust=-0.17,vjust=1))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ggplot(mean_weather5)+ggtitle("B)")+
geom_point(aes(x=max_5,y=days_90_10),shape=19)+
geom_smooth(aes(x=max_5,y=days_90_10),method="lm",color="black",se=F)+
xlab("Maximum daily temperature May")+ylab(NULL)+my_theme()+
theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.17,vjust=1,color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ncol=2,left=textGrob("Duration of flowering season",
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90,hjust=0.46))
fig3<-grid.arrange(fig3A,fig3B)
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig3.tiff",
plot=fig3,device="tiff",width=19,height=18,units="cm",dpi=600)
fig3A<-grid.arrange(
ggplot(mean_weather5)+ggtitle("A)")+
geom_point(aes(x=min_4,y=date_10),shape=24)+
geom_smooth(aes(x=min_4,y=date_10),method="lm",color="black",lty="dashed",se=F)+
geom_point(aes(x=min_4,y=FFD_mean),shape=19)+
geom_smooth(aes(x=min_4,y=FFD_mean),method="lm",color="black",se=F)+
geom_point(aes(x=min_4,y=date_90),shape=8)+
geom_smooth(aes(x=min_4,y=date_90),method="lm",color="black",lty="dotted",se=F)+
xlab(NULL)+ylab(NULL)+my_theme()+
scale_y_continuous(limits=c(40,80))+
theme(plot.title=element_text(hjust=-0.17,vjust=1))+
theme(axis.title.x=element_text(color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ggplot(mean_weather5)+ggtitle("A)")+
geom_point(aes(x=max_5,y=date_10),shape=24)+
geom_smooth(aes(x=max_5,y=date_10),method="lm",color="black",lty="dashed",se=F)+
geom_point(aes(x=max_5,y=FFD_mean),shape=19)+
geom_smooth(aes(x=max_5,y=FFD_mean),method="lm",color="black",se=F)+
geom_point(aes(x=max_5,y=date_90),shape=8)+
geom_smooth(aes(x=max_5,y=date_90),method="lm",color="black",lty="dotted",se=F)+
xlab(NULL)+ylab(NULL)+my_theme()+
scale_y_continuous(limits=c(40,80))+
theme(plot.title=element_text(hjust=-0.17,vjust=1,color="white"))+
theme(axis.title.x=element_text(color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ncol=2,left=textGrob("Day from vernal equinox",
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90,hjust=0.46))
fig3B<-grid.arrange(
ggplot(mean_weather5)+ggtitle("B)")+
geom_point(aes(x=min_4,y=days_90_10),shape=19)+
geom_smooth(aes(x=min_4,y=days_90_10),method="lm",color="black",se=F)+
xlab("Minimum daily temperature April")+ylab(NULL)+my_theme()+
theme(plot.title=element_text(hjust=-0.17,vjust=1))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ggplot(mean_weather5)+ggtitle("B)")+
geom_point(aes(x=max_5,y=days_90_10),shape=19)+
geom_smooth(aes(x=max_5,y=days_90_10),method="lm",color="black",se=F)+
xlab("Maximum daily temperature May")+ylab(NULL)+my_theme()+
theme(plot.title=element_text(hjust=-0.17,vjust=1,color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ncol=2,left=textGrob("Duration of flowering season",
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90,hjust=0.46))
fig3<-grid.arrange(fig3A,fig3B)
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig3.tiff",
plot=fig3,device="tiff",width=19,height=18,units="cm",dpi=600)
fig3A<-grid.arrange(
ggplot(mean_weather5)+ggtitle("A)")+
geom_point(aes(x=min_4,y=date_10),shape=24)+
geom_smooth(aes(x=min_4,y=date_10),method="lm",color="black",lty="dashed",se=F)+
geom_point(aes(x=min_4,y=FFD_mean),shape=19)+
geom_smooth(aes(x=min_4,y=FFD_mean),method="lm",color="black",se=F)+
geom_point(aes(x=min_4,y=date_90),shape=8)+
geom_smooth(aes(x=min_4,y=date_90),method="lm",color="black",lty="dotted",se=F)+
xlab(NULL)+ylab(NULL)+my_theme()+
scale_y_continuous(limits=c(40,80))+
theme(plot.title=element_text(hjust=-0.17,vjust=1))+
theme(axis.title.x=element_text(color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ggplot(mean_weather5)+ggtitle("A)")+
geom_point(aes(x=max_5,y=date_10),shape=24)+
geom_smooth(aes(x=max_5,y=date_10),method="lm",color="black",lty="dashed",se=F)+
geom_point(aes(x=max_5,y=FFD_mean),shape=19)+
geom_smooth(aes(x=max_5,y=FFD_mean),method="lm",color="black",se=F)+
geom_point(aes(x=max_5,y=date_90),shape=8)+
geom_smooth(aes(x=max_5,y=date_90),method="lm",color="black",lty="dotted",se=F)+
xlab(NULL)+ylab(NULL)+my_theme()+
scale_y_continuous(limits=c(40,80))+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.17,vjust=1,color="white"))+
theme(axis.title.x=element_text(color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ncol=2,left=textGrob("Day from vernal equinox",
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90,hjust=0.46))
fig3B<-grid.arrange(
ggplot(mean_weather5)+ggtitle("B)")+
geom_point(aes(x=min_4,y=days_90_10),shape=19)+
geom_smooth(aes(x=min_4,y=days_90_10),method="lm",color="black",se=F)+
xlab("Minimum daily temperature April")+ylab(NULL)+my_theme()+
theme(plot.title=element_text(hjust=-0.17,vjust=1))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ggplot(mean_weather5)+ggtitle("B)")+
geom_point(aes(x=max_5,y=days_90_10),shape=19)+
geom_smooth(aes(x=max_5,y=days_90_10),method="lm",color="black",se=F)+
xlab("Maximum daily temperature May")+ylab(NULL)+my_theme()+
theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.17,vjust=1,color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ncol=2,left=textGrob("Duration of flowering season",
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90,hjust=0.46))
fig3<-grid.arrange(fig3A,fig3B)
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig3.tiff",
plot=fig3,device="tiff",width=19,height=18,units="cm",dpi=600)
fig3A<-grid.arrange(
ggplot(mean_weather5)+ggtitle("A)")+
geom_point(aes(x=min_4,y=date_10),shape=24)+
geom_smooth(aes(x=min_4,y=date_10),method="lm",color="black",lty="dashed",se=F)+
geom_point(aes(x=min_4,y=FFD_mean),shape=19)+
geom_smooth(aes(x=min_4,y=FFD_mean),method="lm",color="black",se=F)+
geom_point(aes(x=min_4,y=date_90),shape=8)+
geom_smooth(aes(x=min_4,y=date_90),method="lm",color="black",lty="dotted",se=F)+
xlab(NULL)+ylab(NULL)+my_theme()+
scale_y_continuous(limits=c(40,80))+
theme(plot.title=element_text(hjust=-0.17,vjust=1))+
theme(axis.text.x=element_text(color="white"))+
theme(axis.title.x=element_text(color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ggplot(mean_weather5)+ggtitle("A)")+
geom_point(aes(x=max_5,y=date_10),shape=24)+
geom_smooth(aes(x=max_5,y=date_10),method="lm",color="black",lty="dashed",se=F)+
geom_point(aes(x=max_5,y=FFD_mean),shape=19)+
geom_smooth(aes(x=max_5,y=FFD_mean),method="lm",color="black",se=F)+
geom_point(aes(x=max_5,y=date_90),shape=8)+
geom_smooth(aes(x=max_5,y=date_90),method="lm",color="black",lty="dotted",se=F)+
xlab(NULL)+ylab(NULL)+my_theme()+
scale_y_continuous(limits=c(40,80))+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.17,vjust=1,color="white"))+
theme(axis.text.x=element_text(color="white"))+
theme(axis.title.x=element_text(color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ncol=2,left=textGrob("Day from vernal equinox",
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90,hjust=0.46))
fig3B<-grid.arrange(
ggplot(mean_weather5)+ggtitle("B)")+
geom_point(aes(x=min_4,y=days_90_10),shape=19)+
geom_smooth(aes(x=min_4,y=days_90_10),method="lm",color="black",se=F)+
xlab("Minimum daily temperature April")+ylab(NULL)+my_theme()+
theme(plot.title=element_text(hjust=-0.17,vjust=1))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ggplot(mean_weather5)+ggtitle("B)")+
geom_point(aes(x=max_5,y=days_90_10),shape=19)+
geom_smooth(aes(x=max_5,y=days_90_10),method="lm",color="black",se=F)+
xlab("Maximum daily temperature May")+ylab(NULL)+my_theme()+
theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.17,vjust=1,color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ncol=2,left=textGrob("Duration of flowering season",
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90,hjust=0.46))
fig3<-grid.arrange(fig3A,fig3B)
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig3.tiff",
plot=fig3,device="tiff",width=19,height=18,units="cm",dpi=600)
fig3A<-grid.arrange(
ggplot(mean_weather5)+ggtitle("A)")+
geom_point(aes(x=min_4,y=date_10),shape=24)+
geom_smooth(aes(x=min_4,y=date_10),method="lm",color="black",lty="dashed",se=F)+
geom_point(aes(x=min_4,y=FFD_mean),shape=19)+
geom_smooth(aes(x=min_4,y=FFD_mean),method="lm",color="black",se=F)+
geom_point(aes(x=min_4,y=date_90),shape=8)+
geom_smooth(aes(x=min_4,y=date_90),method="lm",color="black",lty="dotted",se=F)+
xlab(NULL)+ylab(NULL)+my_theme()+
scale_y_continuous(limits=c(40,80))+
theme(plot.title=element_text(hjust=-0.17,vjust=1))+
theme(axis.text.x=element_text(color="white"))+
theme(axis.title.x=element_text(color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ggplot(mean_weather5)+ggtitle("A)")+
geom_point(aes(x=max_5,y=date_10),shape=24)+
geom_smooth(aes(x=max_5,y=date_10),method="lm",color="black",lty="dashed",se=F)+
geom_point(aes(x=max_5,y=FFD_mean),shape=19)+
geom_smooth(aes(x=max_5,y=FFD_mean),method="lm",color="black",se=F)+
geom_point(aes(x=max_5,y=date_90),shape=8)+
geom_smooth(aes(x=max_5,y=date_90),method="lm",color="black",lty="dotted",se=F)+
xlab(NULL)+ylab(NULL)+my_theme()+
scale_y_continuous(limits=c(40,80))+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.17,vjust=1,color="white"))+
theme(axis.text.x=element_text(color="white"))+
theme(axis.title.x=element_text(color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ncol=2,left=textGrob("Day from vernal equinox",
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90,hjust=0.46))
fig3B<-grid.arrange(
ggplot(mean_weather5)+ggtitle("B)")+
geom_point(aes(x=min_4,y=days_90_10),shape=19)+
geom_smooth(aes(x=min_4,y=days_90_10),method="lm",color="black",se=F)+
xlab("Minimum daily temperature April")+ylab(NULL)+my_theme()+
theme(plot.title=element_text(hjust=-0.17,vjust=1))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ggplot(mean_weather5)+ggtitle("B)")+
geom_point(aes(x=max_5,y=days_90_10),shape=19)+
geom_smooth(aes(x=max_5,y=days_90_10),method="lm",color="black",se=F)+
xlab("Maximum daily temperature May")+ylab(NULL)+my_theme()+
theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.17,vjust=1,color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ncol=2,left=textGrob("Duration of flowering season",
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90,hjust=0.46))
fig3<-grid.arrange(fig3A,fig3B)
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig3.tiff",
plot=fig3,device="tiff",width=19,height=18,units="cm",dpi=600)
fig3A<-grid.arrange(
ggplot(mean_weather5)+ggtitle("A)")+
geom_point(aes(x=min_4,y=date_10),shape=24)+
geom_smooth(aes(x=min_4,y=date_10),method="lm",color="black",lty="dashed",se=F)+
geom_point(aes(x=min_4,y=FFD_mean),shape=19)+
geom_smooth(aes(x=min_4,y=FFD_mean),method="lm",color="black",se=F)+
geom_point(aes(x=min_4,y=date_90),shape=8)+
geom_smooth(aes(x=min_4,y=date_90),method="lm",color="black",lty="dotted",se=F)+
xlab(NULL)+ylab(NULL)+my_theme()+
scale_y_continuous(limits=c(40,80))+
theme(plot.title=element_text(hjust=-0.17,vjust=1))+
theme(axis.text.x=element_text(color="white"))+
theme(axis.title.x=element_text(color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ggplot(mean_weather5)+ggtitle("A)")+
geom_point(aes(x=max_5,y=date_10),shape=24)+
geom_smooth(aes(x=max_5,y=date_10),method="lm",color="black",lty="dashed",se=F)+
geom_point(aes(x=max_5,y=FFD_mean),shape=19)+
geom_smooth(aes(x=max_5,y=FFD_mean),method="lm",color="black",se=F)+
geom_point(aes(x=max_5,y=date_90),shape=8)+
geom_smooth(aes(x=max_5,y=date_90),method="lm",color="black",lty="dotted",se=F)+
xlab(NULL)+ylab(NULL)+my_theme()+
scale_y_continuous(limits=c(40,80))+theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.17,vjust=1,color="white"))+
theme(axis.text.x=element_text(color="white"))+
theme(axis.title.x=element_text(color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ncol=2,left=textGrob("Day from vernal equinox",
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90,hjust=0.46))
fig3B<-grid.arrange(
ggplot(mean_weather5)+ggtitle("B)")+
geom_point(aes(x=min_4,y=days_90_10),shape=19)+
geom_smooth(aes(x=min_4,y=days_90_10),method="lm",color="black",se=F)+
xlab("Minimum daily temperature April")+ylab(NULL)+my_theme()+
theme(plot.title=element_text(hjust=-0.17,vjust=1))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ggplot(mean_weather5)+ggtitle("B)")+
geom_point(aes(x=max_5,y=days_90_10),shape=19)+
geom_smooth(aes(x=max_5,y=days_90_10),method="lm",color="black",se=F)+
xlab("Maximum daily temperature May")+ylab(NULL)+my_theme()+
theme(axis.text.y=element_text(color="white"))+
theme(plot.title=element_text(hjust=-0.17,vjust=1,color="white"))+
theme(plot.margin = unit(c(0.07,0.2,0.07,0.2), "cm")),
ncol=2,left=textGrob("Duration of flowering season",
gp=gpar(fontsize=16,fontfamily="serif"),rot = 90,hjust=0.46))
fig3<-grid.arrange(fig3A,fig3B)
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/results/figures/fig3.tiff",
plot=fig3,device="tiff",width=19,height=18,units="cm",dpi=600)
# Climate
grid.arrange(
ggplot(data_sel,aes(x=GDD5_3,y=n_intact_seeds))+
geom_point()+geom_smooth(method="lm",se=F)+my_theme(),
ggplot(data_sel,aes(x=precipitation_4,y=n_intact_seeds))+
geom_point()+geom_smooth(method="lm",se=F)+my_theme(),
# Duration
ggplot(data_sel,aes(x=days_90_10,y=n_intact_seeds))+
geom_point()+geom_smooth(method="lm",se=F)+my_theme(),
ncol=3)
Anova(lmer(n_intact_seeds_rel ~ FFD_std+FFD_std:year+(1|id),data = data_sel),type="II")
#Indirect selection for early flowering differs among years
Anova(lmer(n_intact_seeds_rel ~ FFD_std+FFD_std:year+n_fl_std+(1|id),data = data_sel),type="II")
#Direct selection for early flowering differs among years
names(data_sel)
# Variables to use
subset3<-data_sel[c(3,44:46,158:160,170:172,182:184,195:196,202)]
names(subset3)
subset3[,c(5:16)]<-scale(subset3[,c(5:16)])
globmod_selection<-lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+
FFD_std:max_3+FFD_std:max_4+FFD_std:max_5+
FFD_std:mean_3+FFD_std:mean_4+FFD_std:mean_5+
FFD_std:min_3+FFD_std:min_4+FFD_std:min_5+
FFD_std:precipitation_13+FFD_std:precipitation_4+
FFD_std:precipitation_5+(1|id),
data = subset3,REML=FALSE,na.action="na.fail")
summary(globmod_selection)
cor(subset3[, -c(1:4)])
names(subset3)
# Excluding collinear variables with r > 0.5
smat3 <- abs(cor(subset3[, -c(1:4)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat3[!lower.tri(smat3)] <- NA
smat3
names(smat3[1,1:17])
names(smat3[1,1:12])
rownames(smat3)<-paste("FFD_std:", names(smat3[1,1:12]),sep="")
colnames(smat3)<-paste("FFD_std:", names(smat3[1,1:12]),sep="")
smat3
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust1 <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterEvalQ(clust1, library(lme4))
modsel_selection<-pdredge(globmod_selection,subset=smat3,fixed=c("FFD_std","n_fl_std"),
cluster=clust1)
summary(model.avg(modsel_selection,subset=delta<2)) # Summary averaged model
subset3<-data_sel[c(3,44:46,158:160,170:172,182:184,195:196,202)]
subset3[,c(5:16)]<-scale(subset3[,c(5:16)])
globmod_selection<-lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+
FFD_std:max_3+FFD_std:max_4+FFD_std:max_5+
FFD_std:mean_3+FFD_std:mean_4+FFD_std:mean_5+
FFD_std:min_3+FFD_std:min_4+FFD_std:min_5+
FFD_std:precipitation_13+FFD_std:precipitation_4+
FFD_std:precipitation_5+(1|id),
data = subset3,REML=FALSE,na.action="na.fail")
# Excluding collinear variables with r > 0.5
smat3 <- abs(cor(subset3[, -c(1:4)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat3[!lower.tri(smat3)] <- NA
rownames(smat3)<-paste("FFD_std:", names(smat3[1,1:12]),sep="")
colnames(smat3)<-paste("FFD_std:", names(smat3[1,1:12]),sep="")
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust1 <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust1, "subset3")
clusterEvalQ(clust1, library(lme4))
modsel_selection<-pdredge(globmod_selection,subset=smat3,fixed=c("FFD_std","n_fl_std"),
cluster=clust1)
summary(model.avg(modsel_selection,subset=delta<2)) # Summary averaged model
importance(modsel_selection) # Variable importance
nobs(globmod_selection)
subset3<-data_sel[c(3,44:46,86:88,158:160,170:172,182:184,189,193:196)]
subset3[,c(5:21)]<-scale(subset3[,c(5:21)])
globmod_selection<-lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+
FFD_std:GDD5_3+FFD_std:GDD5_4+FFD_std:GDD5_5+
FFD_std:max_3+FFD_std:max_4+FFD_std:max_5+
FFD_std:mean_3+FFD_std:mean_4+FFD_std:mean_5+
FFD_std:min_3+FFD_std:min_4+FFD_std:min_5+
FFD_std:precipitation_1+FFD_std:precipitation_2+
FFD_std:precipitation_3+FFD_std:precipitation_4+
FFD_std:precipitation_5+(1|id),
data = subset3,REML=FALSE,na.action="na.fail")
# Excluding collinear variables with r > 0.5
smat3 <- abs(cor(subset3[, -c(1:4)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat3[!lower.tri(smat3)] <- NA
rownames(smat3)<-paste("FFD_std:", names(smat3[1,1:17]),sep="")
colnames(smat3)<-paste("FFD_std:", names(smat3[1,1:17]),sep="")
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust1 <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust1, "subset3")
clusterEvalQ(clust1, library(lme4))
modsel_selection<-pdredge(globmod_selection,subset=smat3,fixed=c("FFD_std","n_fl_std"),
cluster=clust1)
summary(model.avg(modsel_selection,subset=delta<2)) # Summary averaged model
subset3<-data_sel[c(3,44:46,158:160,170:172,182:184,189,193:196)]
names(subset3)
subset3<-data_sel[c(3,44:46,158:160,170:172,182:184,189,193:196)]
subset3[,c(5:18)]<-scale(subset3[,c(5:18)])
globmod_selection<-lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+
FFD_std:max_3+FFD_std:max_4+FFD_std:max_5+
FFD_std:mean_3+FFD_std:mean_4+FFD_std:mean_5+
FFD_std:min_3+FFD_std:min_4+FFD_std:min_5+
FFD_std:precipitation_1+FFD_std:precipitation_2+
FFD_std:precipitation_3+FFD_std:precipitation_4+
FFD_std:precipitation_5+(1|id),
data = subset3,REML=FALSE,na.action="na.fail")
# Excluding collinear variables with r > 0.5
smat3 <- abs(cor(subset3[, -c(1:4)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat3[!lower.tri(smat3)] <- NA
rownames(smat3)<-paste("FFD_std:", names(smat3[1,1:14]),sep="")
colnames(smat3)<-paste("FFD_std:", names(smat3[1,1:14]),sep="")
smat3
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust1 <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust1, "subset3")
clusterEvalQ(clust1, library(lme4))
modsel_selection<-pdredge(globmod_selection,subset=smat3,fixed=c("FFD_std","n_fl_std"),
cluster=clust1)
summary(model.avg(modsel_selection,subset=delta<2)) # Summary averaged model
importance(modsel_selection) # Variable importance
names(data_sel)
subset3<-data_sel[c(3,44:46,158:160,170:172,182:184,194:196)]
names(subset3)
subset3<-data_sel[c(3,44:46,158:160,170:172,182:184,194:196)]
subset3[,c(5:16)]<-scale(subset3[,c(5:16)])
globmod_selection<-lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+
FFD_std:max_3+FFD_std:max_4+FFD_std:max_5+
FFD_std:mean_3+FFD_std:mean_4+FFD_std:mean_5+
FFD_std:min_3+FFD_std:min_4+FFD_std:min_5+
FFD_std:precipitation_3+FFD_std:precipitation_4+
FFD_std:precipitation_5+(1|id),
data = subset3,REML=FALSE,na.action="na.fail")
# Excluding collinear variables with r > 0.5
smat3 <- abs(cor(subset3[, -c(1:4)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat3[!lower.tri(smat3)] <- NA
names(smat)
names(smat3)
smat3
rownames(smat3)<-paste("FFD_std:", names(smat3[1,1:12]),sep="")
colnames(smat3)<-paste("FFD_std:", names(smat3[1,1:12]),sep="")
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust1 <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clust1 <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust1, "subset3")
clusterExport(clust1, "subset3")
clusterEvalQ(clust1, library(lme4))
clusterExport(clust1, "subset3")
clusterEvalQ(clust1, library(lme4))
modsel_selection<-pdredge(globmod_selection,subset=smat3,fixed=c("FFD_std","n_fl_std"),
cluster=clust1)
modsel_selection<-pdredge(globmod_selection,subset=smat3,fixed=c("FFD_std","n_fl_std"),
cluster=clust1)
summary(model.avg(modsel_selection,subset=delta<2)) # Summary averaged model
importance(modsel_selection) # Variable importance
