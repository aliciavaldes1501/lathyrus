temperature_wide %>% group_by(month) %>%
do(models_min=summary(lm(min_S ~ min_O, data = .)))%>%
n(models_min))
temperature_wide %>% group_by(month) %>%
do(models_min=summary(lm(min_S ~ min_O, data = .)))%>%
n(models_min
)
temperature_wide %>% group_by(month) %>%
do(models_min=summary(lm(min_S ~ min_O, data = .)))%>%
n(models_min)
temperature_wide %>% group_by(month) %>%
do(models_min=summary(lm(min_S ~ min_O, data = .)))%>%
n()
# Models min_S vs mi_O for each month
models_min<-as.data.frame(temperature_wide %>% group_by(month) %>%
do(models_min=summary(lm(min_S ~ min_O, data = .)))%>%
n(models_min))
temperature_wide %>% group_by(month) %>%
do(models_min=summary(lm(min_S ~ min_O, data = .)))%>%
tidy(models_min)
# Models min_S vs mi_O for each month
models_min<-as.data.frame(temperature_wide %>% group_by(month) %>%
do(models_min=summary(lm(min_S ~ min_O, data = .)))%>%
tidy(models_min))
models_min$sig<-ifelse(models_min$p.value<0.001,"***",ifelse(models_min$p.value<0.01,"**",ifelse(models_min$p.value<0.05,"*","")))
models_min
# Models min_S vs mi_O for each month
models_min<-as.data.frame(temperature_wide %>% group_by(month) %>%
do(models_min=lm(min_S ~ min_O, data = .))%>%
tidy(models_min))
models_min
temperature_wide %>% group_by(month) %>%
do(models_min=lm(min_S ~ min_O, data = .))%>%
tidy(models_min)
temperature_wide %>% group_by(month) %>%
do(models_min=summary(lm(min_S ~ min_O, data = .)))%>%
tidy(models_min)
temperature_wide %>% group_by(month) %>%
mutate(models_min=summary(lm(min_S ~ min_O, data = .))%>%
tidy(models_min))
mutate(models_min=summary(lm(min_S ~ min_O, data = .))
temperature_wide %>% group_by(month) %>%
mutate(models_min=summary(lm(min_S ~ min_O, data = .)))
temperature_wide %>% group_by(month) %>%
mutate(models_min=summary(lm(min_S ~ min_O, data = .)))
temperature_wide %>% group_by(month) %>%
mutate(models_min=map(summary(lm(min_S ~ min_O, data = .))))
temperature_wide %>% group_by(month) %>%
mutate(models_min=map(lm(min_S ~ min_O, data = .)))
temperature_wide<-gather(temperature[c(1:6,8,10)], variable, value,mean,min,max) %>%
unite(var, variable, station) %>%
spread(var, value) #Convert to wide format with station variables
names(temperature_wide)<-c("date","year","month","day","max_O","max_S","mean_O","mean_S","min_O","min_S")
# Check for NAs
nrow(subset(temperature_wide,is.na(min_O)|is.na(min_S)))
nrow(subset(temperature_wide,is.na(mean_O)|is.na(mean_S)))
nrow(subset(temperature_wide,is.na(max_O)|is.na(max_S)))
unique(as.data.frame(temperature_wide%>%
group_by(year, month)%>%
filter(is.na(min_O)))[2:3])
unique(as.data.frame(temperature_wide%>%
group_by(year, month)%>%
filter(is.na(min_S)))[2:3])
unique(as.data.frame(temperature_wide%>%
group_by(year, month)%>%
filter(is.na(mean_O)))[2:3])
unique(as.data.frame(temperature_wide%>%
group_by(year, month)%>%
filter(is.na(mean_S)))[2:3])
unique(as.data.frame(temperature_wide%>%
group_by(year, month)%>%
filter(is.na(max_O)))[2:3])
unique(as.data.frame(temperature_wide%>%
group_by(year, month)%>%
filter(is.na(max_S)))[2:3])
# Models mean_S vs mean_O for each month
models_mean<-as.data.frame(temperature_wide %>% group_by(month) %>%
do(models_mean=summary(lm(mean_S ~ mean_O, data = .)))%>%
tidy(models_mean))
models_mean$sig<-ifelse(models_mean$p.value<0.001,"***",ifelse(models_mean$p.value<0.01,"**",ifelse(models_mean$p.value<0.05,"*","")))
models_mean
models_mean_rsquare<-as.data.frame(temperature_wide %>% group_by(month) %>%
do(models_mean=summary(lm(mean_S ~ mean_O, data = .)))%>%
glance(models_mean))[c(1,3)]
models_mean_rsquare
# Models min_S vs mi_O for each month
models_min<-as.data.frame(temperature_wide %>% group_by(month) %>%
do(models_min=summary(lm(min_S ~ min_O, data = .)))%>%
tidy(models_min))
models_min$sig<-ifelse(models_min$p.value<0.001,"***",ifelse(models_min$p.value<0.01,"**",ifelse(models_min$p.value<0.05,"*","")))
models_min
models_min_rsquare<-as.data.frame(temperature_wide %>% group_by(month) %>%
do(models_min=summary(lm(min_S ~ min_O, data = .)))%>%
glance(models_min))[c(1,3)]
models_min_rsquare
# Models max_S vs max_O for each month
models_max<-as.data.frame(temperature_wide %>% group_by(month) %>%
do(models_max=summary(lm(max_S ~ max_O, data = .)))%>%
tidy(models_max))
models_max$sig<-ifelse(models_max$p.value<0.001,"***",ifelse(models_max$p.value<0.01,"**",ifelse(models_max$p.value<0.05,"*","")))
models_max
models_max_rsquare<-as.data.frame(temperature_wide %>% group_by(month) %>%
do(models_max=summary(lm(max_S ~ max_O, data = .)))%>%
glance(models_max))[c(1,3)]
models_max_rsquare
models_min
models_min_rsquare
models_mean
models_mean_rsquare
models_max
models_max_rsquare
with(summarySE(data_sel, measurevar="FFD", groupvars=c("year_int")),tidy(lm(FFD~year_int))) #*
knitr::opts_chunk$set(echo = TRUE)
library(broom)
library(knitr)
library(car)
library(ggplot2)
library(fmsb)
library(gridExtra)
library(papeR)
library(agricolae)
library(ggthemes)
library(ggpubr)
library(lemon)
library(grid)
library(lme4)
library(lmerTest)
library(Rmisc)
library(dplyr)
library(MuMIn)
library(effects)
library(parallel)
library(beepr)
library(RColorBrewer)
library(ggridges)
library(tidyverse)
library(sciplot)
library(tidyr)
library(lubridate)
library(knitr)
library(reshape)
library(pander)
library(moments)
library(papeR)
with(summarySE(data_sel, measurevar="FFD", groupvars=c("year_int")),tidy(lm(FFD~year_int))) #*
with(summarySE(data_sel, measurevar="FFD", groupvars=c("year_int")),summary(lm(FFD~year_int))) #*
head(data_sel)
str(data_sel)
str(data_sel,data==1)
str(data_sel,data=1)
table(data_sel$year)
table(data_sel$year,data_sel$id)
library(Rcmdr)
library(car)
library(Rcmdr)
install.packages("car")
library(car)
library(Rcmdr)
knitr::opts_chunk$set(echo = TRUE)
library(broom)
library(knitr)
library(car)
library(ggplot2)
library(fmsb)
library(gridExtra)
library(papeR)
library(agricolae)
library(ggthemes)
library(ggpubr)
library(lemon)
library(grid)
library(lme4)
library(lmerTest)
library(Rmisc)
library(dplyr)
library(MuMIn)
library(effects)
library(parallel)
library(beepr)
library(RColorBrewer)
library(ggridges)
library(tidyverse)
library(sciplot)
library(tidyr)
library(lubridate)
library(knitr)
library(reshape)
library(pander)
library(moments)
library(papeR)
library(Rcmdr)
install.packages("car")
library(c)ar
library(car)
library(Rcmdr)
table(data_sel$id)
table(data_sel$year)
subset(data_sel,year==1995)
str(subset(data_sel,year==1995))
table(data_sel$year)
summary(globmod_direct_selection)
knitr::opts_chunk$set(echo = TRUE)
library(broom)
library(knitr)
library(car)
library(ggplot2)
library(fmsb)
library(gridExtra)
library(papeR)
library(agricolae)
library(ggthemes)
library(ggpubr)
library(lemon)
library(grid)
library(lme4)
library(lmerTest)
library(Rmisc)
library(dplyr)
library(MuMIn)
library(effects)
library(parallel)
library(beepr)
library(RColorBrewer)
library(ggridges)
library(tidyverse)
library(sciplot)
library(tidyr)
library(lubridate)
library(knitr)
library(reshape)
library(pander)
library(moments)
library(papeR)
summary(lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+
FFD_std:max_3+FFD_std:max_4+FFD_std:max_5+
FFD_std:mean_3+FFD_std:mean_4+FFD_std:mean_5+
FFD_std:min_3+FFD_std:min_4+FFD_std:min_5+
FFD_std:precipitation_3+FFD_std:precipitation_4+
FFD_std:precipitation_5+(1|id),
data = subset4,REML=FALSE,na.action="na.fail"))
summary(lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+
FFD_std:min_4+FFD_std:precipitation_3+(1|id),
data = subset4,REML=FALSE,na.action="na.fail"))
summary(lmer(n_intact_seeds_rel ~ FFD_std+n_fl_std+
FFD_std:min_4:precipitation_3+(1|id),
data = subset4,REML=FALSE,na.action="na.fail"))
knitr::opts_chunk$set(echo = TRUE)
library(broom)
library(knitr)
library(car)
library(ggplot2)
library(fmsb)
library(gridExtra)
library(papeR)
library(agricolae)
library(ggthemes)
library(ggpubr)
library(lemon)
library(grid)
library(lme4)
library(lmerTest)
library(Rmisc)
library(dplyr)
library(MuMIn)
library(effects)
library(parallel)
library(beepr)
library(RColorBrewer)
library(ggridges)
library(tidyverse)
library(sciplot)
library(tidyr)
library(lubridate)
library(knitr)
library(reshape)
library(pander)
library(moments)
library(papeR)
get.models(modsel_FFD,subset=1)$"1585"
summary(model.avg(modsel_FFD,subset=delta<2)) # Summary averaged model
summary(lmer(FFD ~ max_3 + mean_4 + mean_5 + precipitation_3 + precipitation_4 +      n_fl + (1 | id),
data = subset1,REML=FALSE,na.action="na.fail"))
summary(lmer(FFD ~ mean_4+mean_5+precipitation_3+precipitation_4+n_fl+(1 | id),
data = subset1,REML=FALSE,na.action="na.fail"))
modelito<-lmer(FFD ~ mean_4+mean_5+precipitation_3+precipitation_4+n_fl+(1 | id),
data = subset1,REML=FALSE,na.action="na.fail")
summary(modelito)
predict(modelito)
?predict
summary(modelito)
predict(modelito,mean_5=-3)
predict(modelito,mean_5=-3)
summary(modelito)
summary(model.avg(modsel_FFD,subset=delta<2)) # Summary averaged model
ggplot(data_sel,aes(x=mean_4,y=FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
xlab("Mean daily temperature April")+ylab(NULL)+my_theme()+
theme(plot.title=element_text(hjust=-0.13,vjust=2))
ggplot(data_sel,aes(x=mean_4,y=FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
xlab("Mean daily temperature April")+ylab(NULL)+
theme(plot.title=element_text(hjust=-0.13,vjust=2))
ggplot(data_sel,aes(x=mean_4,y=FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
xlab("Mean daily temperature April")+
theme(plot.title=element_text(hjust=-0.13,vjust=2))
ggplot(data_sel,aes(x=mean_4,y=FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
xlab("Mean daily temperature April")+
scale_y_continuous(breaks=10)
?scale_y_continuous
c(1,10,1)
seq(1,10,1)
seq(40,80,1)
ggplot(data_sel,aes(x=mean_4,y=FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
xlab("Mean daily temperature April")+
scale_y_continuous(breaks=seq(40,80,1))
ggplot(data_sel,aes(x=mean_4,y=FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
xlab("Mean daily temperature April")+
scale_y_continuous(breaks=seq(35,85,1))
ggplot(data_sel,aes(x=mean_4,y=FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
xlab("Mean daily temperature April")+
scale_y_continuous(breaks=seq(35,85,1))+
scale_x_continuous(breaks=seq(4,8,1))
ggplot(data_sel,aes(x=mean_4,y=FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
xlab("Mean daily temperature April")+
scale_y_continuous(breaks=seq(35,85,1))+
scale_x_continuous(breaks=seq(3,9,1))
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/scratch/fig1.tiff",
device="tiff",width=38,height=90,units="cm",dpi=600)
ggplot(data_sel,aes(x=mean_5,y=FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
xlab("Mean daily temperature May")+
scale_y_continuous(breaks=seq(35,85,1))+
scale_x_continuous(breaks=seq(3,9,1))
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/scratch/fig1.tiff",
device="tiff",width=38,height=90,units="cm",dpi=600)
ggplot(data_sel,aes(x=mean_5,y=FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
xlab("Mean daily temperature May")+
scale_y_continuous(breaks=seq(35,85,1))
ggplot(data_sel,aes(x=mean_5,y=FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
xlab("Mean daily temperature May")+
scale_y_continuous(breaks=seq(35,85,1))+
scale_x_continuous(breaks=seq(8,14,1))
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/scratch/fig1.tiff",
device="tiff",width=38,height=90,units="cm",dpi=600)
ggplot(data_sel,aes(x=precipitation_3,y=FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)
ggplot(data_sel,aes(x=precipitation_3,y=FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
scale_y_continuous(breaks=seq(35,85,1))+
scale_x_continuous(breaks=seq(10,80,1))
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/scratch/fig1.tiff",
device="tiff",width=38,height=90,units="cm",dpi=600)
ggplot(data_sel,aes(x=precipitation_3,y=FFD))+ggtitle("A)")+
geom_point(size=1)+geom_smooth(method="lm",color="black",se=F)+
scale_y_continuous(breaks=seq(35,85,1))+
scale_x_continuous(breaks=seq(0,80,1))
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/scratch/fig1.tiff",
device="tiff",width=38,height=90,units="cm",dpi=600)
ggsave(filename="C:/Users/User/Dropbox/SU/Projects/lathyrus/scratch/fig1.tiff",
device="tiff",width=50,height=50,units="cm",dpi=600)
summary(lm(FFD~mean_4))
summary(lm(FFD~mean_4,data=subset1))
summary(lm(FFD~precipitation_3,data=subset1))
summary(lm(FFD~mean_4,data=data_sel))
summary(lm(FFD~precipitation_3,data=data_sel))
knitr::opts_chunk$set(echo = TRUE)
library(broom)
library(knitr)
library(car)
library(ggplot2)
library(fmsb)
library(gridExtra)
library(papeR)
library(agricolae)
library(ggthemes)
library(ggpubr)
library(lemon)
library(grid)
library(lme4)
library(lmerTest)
library(Rmisc)
library(dplyr)
library(MuMIn)
library(effects)
library(parallel)
library(beepr)
library(RColorBrewer)
library(ggridges)
library(tidyverse)
library(sciplot)
library(tidyr)
library(lubridate)
library(knitr)
library(reshape)
library(pander)
library(moments)
library(papeR)
summary(lm(days_90_10~scale(mean_4)+scale(mean_5)+
scale(precipitation_3)+scale(precipitation_4),data=mean_weather4))
## Including year  (Table S2)
summary(lm(days_90_10~scale(mean_4)+scale(mean_5)+
scale(precipitation_3)+scale(precipitation_4)+
as.integer(as.character(year)),data=mean_weather4))
with(mean_weather4,cor(date_10,days_90_10))
with(mean_weather4,cor(date_90,days_90_10))
with(mean_weather4,cor(FFD_mean,days_90_10))
with(mean_weather4,plot(date_10,days_90_10))
with(mean_weather4,abline(lm(days_90_10~date_10))
)
with(mean_weather4,summary(lm(days_90_10~date_10)))
with(mean_weather4,summary(lm(days_90_10~date_90)))
with(mean_weather4,plot(date_90,days_90_10))
with(mean_weather4,abline(lm(days_90_10~date_90)))
with(mean_weather4,cor(precipitation_3,mean_3))
with(mean_weather4,cor(precipitation_3,mean_4))
with(mean_weather4,cor(precipitation_4,mean_4))
smat1
cor(subset1[, -c(1,2,3)])
cor(subset1[, -c(1,2,3)])
cor(subset1[, -c(1,2,3)])
summary(lmer(n_intact_seeds ~ max_3+max_4+max_5+mean_3+mean_4+mean_5+
min_3+min_4+min_5+precipitation_3+precipitation_4+precipitation_5+
n_fl+(1|id),data = subset2,REML=FALSE,na.action="na.fail"))
summary(lmer(n_intact_seeds ~ max_4+
n_fl+(1|id),data = subset2,REML=FALSE,na.action="na.fail"))
summary(lmer(n_intact_seeds ~ min_5+
n_fl+(1|id),data = subset2,REML=FALSE,na.action="na.fail"))
with(subset2,plot(n_intact_seeds~max_4))
with(subset2,abline(lm(n_intact_seeds~max_4)))
summary(lmer(n_intact_seeds ~ precipitation_3+
n_fl+(1|id),data = subset2,REML=FALSE,na.action="na.fail"))
summary(lmer(n_intact_seeds ~ precipitation_4+
n_fl+(1|id),data = subset2,REML=FALSE,na.action="na.fail"))
summary(lmer(n_intact_seeds ~ precipitation_5+
n_fl+(1|id),data = subset2,REML=FALSE,na.action="na.fail"))
names(data_sel)
# Variables to use
subset2<-data_sel[c(3,20,42,56,158:160,170:172,182:184,194:196)]
names(subset2)
# Variables to use
subset2<-data_sel[c(3,20,42,47,56,158:160,170:172,182:184,194:196)]
subset2[,c(3:17)]<-scale(subset2[,c(3:17)])
globmod_fitness<-lmer(n_intact_seeds ~ max_3+max_4+max_5+mean_3+mean_4+mean_5+
min_3+min_4+min_5+precipitation_3+precipitation_4+precipitation_5+
FFD_mean+days_90_10+n_fl+(1|id),data = subset2,REML=FALSE,na.action="na.fail")
# Excluding collinear variables with r > 0.5
smat2 <- abs(cor(subset2[, -c(1:3)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat2
smat2[!lower.tri(smat2)] <- NA
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust1 <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust1, "subset2")
clusterEvalQ(clust1, library(lme4))
knitr::opts_chunk$set(echo = TRUE)
library(broom)
library(knitr)
library(car)
library(ggplot2)
library(fmsb)
library(gridExtra)
library(papeR)
library(agricolae)
library(ggthemes)
library(ggpubr)
library(lemon)
library(grid)
library(lme4)
library(lmerTest)
library(Rmisc)
library(dplyr)
library(MuMIn)
library(effects)
library(parallel)
library(beepr)
library(RColorBrewer)
library(ggridges)
library(tidyverse)
library(sciplot)
library(tidyr)
library(lubridate)
library(knitr)
library(reshape)
library(pander)
library(moments)
library(papeR)
# Variables to use
subset2<-data_sel[c(3,20,42,47,56,158:160,170:172,182:184,194:196)]
subset2[,c(3:17)]<-scale(subset2[,c(3:17)])
globmod_fitness<-lmer(n_intact_seeds ~ max_3+max_4+max_5+mean_3+mean_4+mean_5+
min_3+min_4+min_5+precipitation_3+precipitation_4+precipitation_5+
FFD_mean+days_90_10+n_fl+(1|id),data = subset2,REML=FALSE,na.action="na.fail")
# Excluding collinear variables with r > 0.5
smat2 <- abs(cor(subset2[, -c(1:3)])) <= .5 # TRUE: cor<=0.5,FALSE: cor>0.5
smat2[!lower.tri(smat2)] <- NA
clusterType <- if(length(find.package("snow", quiet = TRUE))) "SOCK" else "PSOCK"
clust1 <- try(makeCluster(getOption("cl.cores", 3), type = clusterType))
clusterExport(clust1, "subset2")
clusterEvalQ(clust1, library(lme4))
modsel_fitness<-pdredge(globmod_fitness,subset=smat2,fixed="n_fl",cluster=clust1)
summary(model.avg(modsel_fitness,subset=delta<2)) # Summary averaged model
get.models(modsel_fitness,subset=1)
importance(modsel_fitness) # Variable importance
summary(get.models(modsel_fitness,subset=1)$6165)
summary(get.models(modsel_fitness,subset=1)$"6165")
