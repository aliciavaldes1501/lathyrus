boxplot(data_imput$FFD,  ylab = "FFD")
dotchart(data_imput$FFD, xlab = "FFD",
ylab = "Order of the data")
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imput$FFD,  ylab = "FFD")
dotchart(data_imput$FFD, xlab = "FFD",
ylab = "Order of the data")
data_imput
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imput$FFD,  ylab = "FFD")
dotchart(data_imput$FFD, xlab = "FFD",
ylab = "Order of the data")
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imput$FFD,  ylab = "FFD")
dotchart(data_imput$FFD, xlab = "FFD",
ylab = "Order of the data")
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imput$FFD,  ylab = "FFD")
dotchart(data_imput$FFD, xlab = "FFD",
ylab = "Order of the data")
getwd()
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imput$FFD,  ylab = "FFD")
dotchart(data_imput$FFD, xlab = "FFD",
ylab = "Order of the data")
getwd()
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imput$FFD,  ylab = "FFD")
dotchart(data_imput$FFD, xlab = "FFD",
ylab = "Order of the data")
getwd()
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imput$FFD,  ylab = "FFD")
dotchart(data_imput$FFD, xlab = "FFD",
ylab = "Order of the data")
ls()
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imput$FFD,  ylab = "FFD")
dotchart(data_imput$FFD, xlab = "FFD",
ylab = "Order of the data")
knit_with_parameters('C:/Users/User/Dropbox/SU/Projects/lathyrus/results/exploratory_analysis.Rmd')
unlink('results/exploratory_analysis_cache', recursive = TRUE)
ls()
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imput$FFD,  ylab = "FFD")
dotchart(data_imput$FFD, xlab = "FFD",
ylab = "Order of the data")
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imput$FFD,  ylab = "FFD")
dotchart(data_imput$FFD, xlab = "FFD",
ylab = "Order of the data")
?write.table
data_imputed_FFD<-write.csv(data_imput,file="C:/Users/User/Dropbox/SU/Projects/lathyrus/data/clean/data_imputed_FFD.csv",sep="\t",dec=".",col.names=T)
data_imputed_FFD<-read.table("C:/Users/User/Dropbox/SU/Projects/lathyrus/data/clean/data_imputed_FFD.csv",
header=T,sep="\t",dec=",") #Read all data
data_imputed_FFD<-read.table("C:/Users/User/Dropbox/SU/Projects/lathyrus/data/clean/data_imputed_FFD.csv",
header=T,sep="\t",dec=",") #Read all data
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imputed_FFD$FFD,  ylab = "FFD")
head(data_imputed_FFD)
data_imputed_FFD<-read.table("C:/Users/User/Dropbox/SU/Projects/lathyrus/data/clean/data_imputed_FFD.csv",
header=T,sep="\t",dec=".") #Read all data
head(data_imputed_FFD)
data_imputed_FFD<-read.table("C:/Users/User/Dropbox/SU/Projects/lathyrus/data/clean/data_imputed_FFD.csv",
header=T,sep="\t",dec=".") #Read all data
head(data_imputed_FFD)
data_imputed_FFD<-write.table(data_imput,file="C:/Users/User/Dropbox/SU/Projects/lathyrus/data/clean/data_imputed_FFD.csv",sep="\t",dec=".",col.names=T)
data_imputed_FFD<-read.table("C:/Users/User/Dropbox/SU/Projects/lathyrus/data/clean/data_imputed_FFD.csv",
header=T,sep="\t",dec=".") #Read all data
data_imputed_FFD<-read.csv("C:/Users/User/Dropbox/SU/Projects/lathyrus/data/clean/data_imputed_FFD.csv",
header=T,sep="\t",dec=".") #Read all data
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imputed_FFD$FFD,  ylab = "FFD")
dotchart(data_imputed_FFD$FFD, xlab = "FFD",
ylab = "Order of the data")
head(data_imputed_FFD)
str(data_imputed_FFD)
data_imputed_FFD<-read.csv("C:/Users/User/Dropbox/SU/Projects/lathyrus/data/clean/data_imputed_FFD.csv",
header=T,sep="\t",dec=".") #Read data
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imputed_FFD$FFD,  ylab = "FFD")
dotchart(data_imputed_FFD$FFD, xlab = "FFD",
ylab = "Order of the data")
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imputed_FFD$FFD,  ylab = "FFD")
dotchart(data_imputed_FFD$FFD, xlab = "FFD",
ylab = "Order of the data")
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imputed_FFD$FFD,  ylab = "FFD")
dotchart(data_imputed_FFD$FFD, xlab = "FFD",
ylab = "Order of the data")
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imputed_FFD$FFD,  ylab = "FFD")
dotchart(data_imputed_FFD$FFD, xlab = "FFD",
ylab = "Order of the data")
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imputed_FFD$FFD,  ylab = "FFD")
dotchart(data_imputed_FFD$FFD, xlab = "FFD",
ylab = "Order of the data")
par(mfrow= c (1,2), mar = c(5,4,2,1))
boxplot(data_imputed_FFD$FFD,  ylab = "FFD")
dotchart(data_imputed_FFD$FFD, xlab = "FFD",
ylab = "Order of the data")
head(data_imputed_FFD)
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules, data_imputed_FFD$total_n_seeds,data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$$FFD)
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules, data_imputed_FFD$total_n_seeds,data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules","total_n_seeds","total_n_intact_seeds","FFD")
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = FALSE),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
library(lattice)
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules, data_imputed_FFD$total_n_seeds,data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules","total_n_seeds","total_n_intact_seeds","FFD")
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = FALSE),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules, data_imputed_FFD$total_n_seeds,data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules","total_n_seeds","total_n_intact_seeds","FFD")
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = T),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules, data_imputed_FFD$total_n_seeds,data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules","total_n_seeds","total_n_intact_seeds","FFD")
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules, data_imputed_FFD$total_n_seeds,data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules","total_n_seeds","total_n_intact_seeds","FFD")
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = T),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules, data_imputed_FFD$total_n_seeds,data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules","total_n_seeds","total_n_intact_seeds","FFD")
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = F),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules, data_imputed_FFD$total_n_seeds,data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules","total_n_seeds","total_n_intact_seeds","FFD")
boxplot(as.matrix(Z))
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = F),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules, data_imputed_FFD$total_n_seeds,data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules","total_n_seeds","total_n_intact_seeds","FFD")
boxplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = F),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = F),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
names(data_imputed_FFD)
boxplot(data_imputed_FFD[c(6:7,9,11:15)])
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules, data_imputed_FFD$total_n_seeds,data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules","total_n_seeds","total_n_intact_seeds","FFD")
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = F),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
boxplot(data_imputed_FFD[c(6:7,9,11:15)],scales="free")
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules, data_imputed_FFD$total_n_seeds,data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules","total_n_seeds","total_n_intact_seeds","FFD")
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = F),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
dotplot(as.matrix(Z), groups = FALSE
boxplot(data_imputed_FFD[c(6:7,9,11:15)],scales="free")
boxplot(as.matrix(Z), groups = FALSE)
head(data_imputed_FFD)
par(mfrow=c(2,4))
boxplot(data_imputed_FFD$grazing)
boxplot(data_imputed_FFD$shoot_vol)
boxplot(data_imputed_FFD$cum_n_fl)
boxplot(data_imputed_FFD$n_fr)
boxplot(data_imputed_FFD$n_ovules)
boxplot(data_imputed_FFD$total_n_seeds)
boxplot(data_imputed_FFD$total_n_intact_seeds)
boxplot(data_imputed_FFD$FFD)
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules, data_imputed_FFD$total_n_seeds,data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules","total_n_seeds","total_n_intact_seeds","FFD")
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = F),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
par(mfrow=c(4,2))
boxplot(data_imputed_FFD$grazing)
boxplot(data_imputed_FFD$shoot_vol)
boxplot(data_imputed_FFD$cum_n_fl)
boxplot(data_imputed_FFD$n_fr)
boxplot(data_imputed_FFD$n_ovules)
boxplot(data_imputed_FFD$total_n_seeds)
boxplot(data_imputed_FFD$total_n_intact_seeds)
boxplot(data_imputed_FFD$FFD)
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules, data_imputed_FFD$total_n_seeds,data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules","total_n_seeds","total_n_intact_seeds","FFD")
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = F),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
par(mfrow=c(2,4))
boxplot(data_imputed_FFD$grazing)
boxplot(data_imputed_FFD$shoot_vol)
boxplot(data_imputed_FFD$cum_n_fl)
boxplot(data_imputed_FFD$n_fr)
boxplot(data_imputed_FFD$n_ovules)
boxplot(data_imputed_FFD$total_n_seeds)
boxplot(data_imputed_FFD$total_n_intact_seeds)
boxplot(data_imputed_FFD$FFD)
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules, data_imputed_FFD$total_n_seeds,data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules","total_n_seeds","total_n_intact_seeds","FFD")
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = F),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
par(mfrow=c(2,4))
boxplot(data_imputed_FFD$grazing,main="grazing")
boxplot(data_imputed_FFD$shoot_vol)
boxplot(data_imputed_FFD$cum_n_fl)
boxplot(data_imputed_FFD$n_fr)
boxplot(data_imputed_FFD$n_ovules)
boxplot(data_imputed_FFD$total_n_seeds)
boxplot(data_imputed_FFD$total_n_intact_seeds)
boxplot(data_imputed_FFD$FFD)
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules, data_imputed_FFD$total_n_seeds,data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules","total_n_seeds","total_n_intact_seeds","FFD")
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = F),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
par(mfrow=c(2,4))
boxplot(data_imputed_FFD$grazing,main="grazing")
boxplot(data_imputed_FFD$shoot_vol,main="shoot_volume")
boxplot(data_imputed_FFD$cum_n_fl,main="n_fl")
boxplot(data_imputed_FFD$n_fr,main="n_fr")
boxplot(data_imputed_FFD$n_ovules,main="n_ovules")
boxplot(data_imputed_FFD$total_n_seeds,main="total_n_seeds")
boxplot(data_imputed_FFD$total_n_intact_seeds,main="total_n_intact_seeds")
boxplot(data_imputed_FFD$FFD,main="FFD")
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules, data_imputed_FFD$total_n_seeds,data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules","total_n_seeds","total_n_intact_seeds","FFD")
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = F),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
par(mfrow=c(2,4))
boxplot(data_imputed_FFD$grazing,main="grazing")
boxplot(data_imputed_FFD$shoot_vol,main="shoot_volume")
boxplot(data_imputed_FFD$cum_n_fl,main="n_fl")
boxplot(data_imputed_FFD$n_fr,main="n_fr")
boxplot(data_imputed_FFD$n_ovules,main="n_ovules")
boxplot(data_imputed_FFD$total_n_seeds,main="total_n_seeds")
boxplot(data_imputed_FFD$total_n_intact_seeds,main="total_n_intact_seeds")
boxplot(data_imputed_FFD$FFD,main="FFD")
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,  data_imputed_FFD$cum_n_fl,
data_imputed_FFD$n_fr,data_imputed_FFD$n_ovules,data_imputed_FFD$total_n_seeds,
data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules","total_n_seeds","total_n_intact_seeds","FFD")
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = F),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
par(mfrow=c(2,4))
boxplot(data_imputed_FFD$grazing,main="grazing")
boxplot(data_imputed_FFD$shoot_vol,main="shoot_volume")
boxplot(data_imputed_FFD$cum_n_fl,main="n_fl")
boxplot(data_imputed_FFD$n_fr,main="n_fr")
boxplot(data_imputed_FFD$n_ovules,main="n_ovules")
boxplot(data_imputed_FFD$total_n_seeds,main="total_n_seeds")
boxplot(data_imputed_FFD$total_n_intact_seeds,main="total_n_intact_seeds")
boxplot(data_imputed_FFD$FFD,main="FFD")
Z <- cbind(data_imputed_FFD$grazing, data_imputed_FFD$shoot_vol,
data_imputed_FFD$cum_n_fl,data_imputed_FFD$n_fr,
data_imputed_FFD$n_ovules,data_imputed_FFD$total_n_seeds,
data_imputed_FFD$total_n_intact_seeds,data_imputed_FFD$FFD)
colnames(Z) <- c("grazing","shoot_vol","n_fl","n_fr","n_ovules",
"total_n_seeds","total_n_intact_seeds","FFD")
dotplot(as.matrix(Z), groups = FALSE,
strip = strip.custom(bg = 'white',
par.strip.text = list(cex = 0.8)),
scales = list(x = list(relation = "free"),
y = list(relation = "free"),
draw = F),
col = 1, cex  = 0.5, pch = 16,
xlab = "Value of the variable",
ylab = "Order of the data from text file")
subset(subset(bud_sizes,year==2006),FFD_action=="impute")
library(tidyr)
library(plyr)
library(sjPlot)
library(ggplot2)
library(fmsb)
data_imput<-read.table("C:/Users/User/Dropbox/SU/Projects/lathyrus/data/clean/data_20062017_forimput.csv",
header=T,sep="\t",dec=",") #Read all data
bud_sizes<-read.table("C:/Users/User/Dropbox/SU/Projects/lathyrus/data/clean/bud_sizes.csv",
header=T,sep="\t",dec=",") #Read data on bud sizes
head(data_imput)
str(data_imput)
data_imput$FFD_corr<-as.Date(as.character(data_imput$FFD_corr),format="%d/%m/%Y")
head(bud_sizes)
bud_sizes[sapply(bud_sizes, function(x) all(is.na(x)))] <- NULL #remove columns with all NAs
str(bud_sizes)
bud_sizes<-gather(bud_sizes, key=day, value=bud_size, X114:X148,factor_key=T) #Convert from wide to long
bud_sizes<-subset(bud_sizes,!bud_size=="") #remove rows with blank bud_size
bud_sizes$day<-as.integer(substring(as.character(bud_sizes$day),2))
bud_sizes$bud_size[bud_sizes$bud_size=="S"] <- 1
bud_sizes$bud_size[bud_sizes$bud_size=="M"] <- 2
bud_sizes$bud_size[bud_sizes$bud_size=="L"] <- 3
bud_sizes$bud_size[bud_sizes$bud_size=="XL"] <-4
bud_sizes$bud_size<-as.integer(bud_sizes$bud_size)
head(bud_sizes)
str(bud_sizes)
#subset to use for building a model of FFD against bud size and day
subset_model<-subset(bud_sizes,!FFD_action=="impute")
with(subset_model,hist(FFD_julian,breaks=50))
with(subset_model,hist(bud_size))
with(subset_model,hist(day))
with(subset_model,plot(as.factor(bud_size)~day))
with(subset_model,plot(FFD_julian~as.factor(bud_size)))
with(subset_model,plot(FFD_julian~day))
model_FFD<-lm(FFD_julian~bud_size*day,subset_model)
summary(model_FFD)
plot(model_FFD)
sjp.int(model_FFD, type = "eff",mdrt.values = "quart",swap.pred=T) #Plot of interaction effect
model_FFD_yrs<-lmList(FFD_julian~bud_size*day|year,data=subset_model) #All yrs
summary(model_FFD_yrs)
plot(model_FFD_yrs)
model_FFD06<-lm(FFD_julian~bud_size+day,subset(subset_model,year==2006))
model_FFD07<-lm(FFD_julian~bud_size+day,subset(subset_model,year==2007))
model_FFD08<-lm(FFD_julian~bud_size+day,subset(subset_model,year==2008))
model_FFD09<-lm(FFD_julian~bud_size+day,subset(subset_model,year==2009))
model_FFD10<-lm(FFD_julian~bud_size*day,subset(subset_model,year==2010))
model_FFD11<-lm(FFD_julian~bud_size*day,subset(subset_model,year==2011))
model_FFD12<-lm(FFD_julian~bud_size*day,subset(subset_model,year==2012))
model_FFD13<-lm(FFD_julian~bud_size*day,subset(subset_model,year==2013))
model_FFD14<-lm(FFD_julian~bud_size*day,subset(subset_model,year==2014))
model_FFD15<-lm(FFD_julian~bud_size+day,subset(subset_model,year==2015))
summary(model_FFD06)
summary(model_FFD07)
summary(model_FFD08)
summary(model_FFD09)
summary(model_FFD10)
summary(model_FFD11)
summary(model_FFD12)
summary(model_FFD13)
summary(model_FFD14)
summary(model_FFD15)
#Compare distributions of predicted vs observed values
data06<-data.frame(observed=subset(subset_model,year==2006)$FFD_julian, predicted=predict(model_FFD06))
data07<-data.frame(observed=subset(subset_model,year==2007)$FFD_julian, predicted=predict(model_FFD07))
data08<-data.frame(observed=subset(subset_model,year==2008)$FFD_julian, predicted=predict(model_FFD08))
data09<-data.frame(observed=subset(subset_model,year==2009)$FFD_julian, predicted=predict(model_FFD09))
data10<-data.frame(observed=subset(subset_model,year==2010)$FFD_julian, predicted=predict(model_FFD10))
data11<-data.frame(observed=subset(subset_model,year==2011)$FFD_julian, predicted=predict(model_FFD11))
data12<-data.frame(observed=subset(subset_model,year==2012)$FFD_julian, predicted=predict(model_FFD12))
data13<-data.frame(observed=subset(subset_model,year==2013)$FFD_julian, predicted=predict(model_FFD13))
data14<-data.frame(observed=subset(subset_model,year==2014)$FFD_julian, predicted=predict(model_FFD14))
data15<-data.frame(observed=subset(subset_model,year==2015)$FFD_julian, predicted=predict(model_FFD15))
ggplot(data06) +geom_density(aes(x=observed),alpha=.3, fill="blue")+geom_density(aes(x=predicted),alpha=.3, fill="red")
ggplot(data07) +geom_density(aes(x=observed),alpha=.3, fill="blue")+geom_density(aes(x=predicted),alpha=.3, fill="red")
ggplot(data08) +geom_density(aes(x=observed),alpha=.3, fill="blue")+geom_density(aes(x=predicted),alpha=.3, fill="red")
ggplot(data09) +geom_density(aes(x=observed),alpha=.3, fill="blue")+geom_density(aes(x=predicted),alpha=.3, fill="red")
ggplot(data10) +geom_density(aes(x=observed),alpha=.3, fill="blue")+geom_density(aes(x=predicted),alpha=.3, fill="red")
ggplot(data11) +geom_density(aes(x=observed),alpha=.3, fill="blue")+geom_density(aes(x=predicted),alpha=.3, fill="red")
ggplot(data12) +geom_density(aes(x=observed),alpha=.3, fill="blue")+geom_density(aes(x=predicted),alpha=.3, fill="red")
ggplot(data13) +geom_density(aes(x=observed),alpha=.3, fill="blue")+geom_density(aes(x=predicted),alpha=.3, fill="red")
ggplot(data14) +geom_density(aes(x=observed),alpha=.3, fill="blue")+geom_density(aes(x=predicted),alpha=.3, fill="red")
ggplot(data15) +geom_density(aes(x=observed),alpha=.3, fill="blue")+geom_density(aes(x=predicted),alpha=.3, fill="red")
#Use per-year models
#or all-year model?
#to predict FFD values where FFD_action=biased/imp_bdsize/impute
subset(subset(bud_sizes,year==2006),FFD_action=="impute")
predict06
predict06<-as.data.frame(predict(model_FFD06,newdata=subset(subset(bud_sizes,year==2006),FFD_action=="impute")))
predict07<-as.data.frame(predict(model_FFD07,newdata=subset(subset(bud_sizes,year==2007),FFD_action=="impute")))
predict08<-as.data.frame(predict(model_FFD08,newdata=subset(subset(bud_sizes,year==2008),FFD_action=="impute")))
predict09<-as.data.frame(predict(model_FFD09,newdata=subset(subset(bud_sizes,year==2009),FFD_action=="impute")))
predict10<-as.data.frame(predict(model_FFD10,newdata=subset(subset(bud_sizes,year==2010),FFD_action=="impute")))
predict11<-as.data.frame(predict(model_FFD11,newdata=subset(subset(bud_sizes,year==2011),FFD_action=="impute")))
predict12<-as.data.frame(predict(model_FFD12,newdata=subset(subset(bud_sizes,year==2012),FFD_action=="impute")))
predict13<-as.data.frame(predict(model_FFD13,newdata=subset(subset(bud_sizes,year==2013),FFD_action=="impute")))
predict14<-as.data.frame(predict(model_FFD14,newdata=subset(subset(bud_sizes,year==2014),FFD_action=="impute")))
predict15<-as.data.frame(predict(model_FFD15,newdata=subset(subset(bud_sizes,year==2015),FFD_action=="impute")))
names(predict06)<-c("FFD_i")
names(predict07)<-c("FFD_i")
names(predict08)<-c("FFD_i")
names(predict09)<-c("FFD_i")
names(predict10)<-c("FFD_i")
names(predict11)<-c("FFD_i")
names(predict12)<-c("FFD_i")
names(predict13)<-c("FFD_i")
names(predict14)<-c("FFD_i")
names(predict15)<-c("FFD_i")
predictions<-rbind(predict06,predict07,predict08,predict09,predict10,predict11,predict12,predict13,predict14,predict15)
bud_sizes<-merge(bud_sizes, predictions, by="row.names",all.x=T) #New colum with imputed FFD (FFD_i) for pls where FFD_action=biased/imp_bdsize/impute
bud_sizes$Row.names<-NULL
bud_sizes$FFD<-ifelse(is.na(bud_sizes$FFD_julian),as.integer(round(bud_sizes$FFD_i)),bud_sizes$FFD_julian)
bud_sizes$FFD_imputed<-ifelse(is.na(bud_sizes$FFD_julian),1,0) #Says if FFD was imputed (1) or not (0)
head(bud_sizes)
bud_sizes$year<-as.factor(bud_sizes$year)
bud_sizes$id<-as.factor(bud_sizes$id)
bud_sizes<-bud_sizes[with(bud_sizes, order(year,id,day)),]
bud_sizes<-unique(bud_sizes[c(1:2,8:9)])
head(bud_sizes)
str(bud_sizes)
subset(bud_sizes,year==2006)
